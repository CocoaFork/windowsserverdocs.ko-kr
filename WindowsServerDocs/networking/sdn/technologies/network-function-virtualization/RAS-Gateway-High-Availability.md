---
title: RAS 게이트웨이 높은 공급 일
description: 에 대 한 소프트웨어 정의 네트워킹 (SDN) Windows Server 2016에 RAS 넌 게이트웨이의 가용성 구성을 대 한 자세한 내용은이 항목을 사용할 수 있습니다.
manager: brianlic
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: networking-sdn
ms.tgt_pltfrm: na
ms.topic: get-started-article
ms.assetid: 34d826c9-65bc-401f-889d-cf84e12f0144
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 48794ff8312ca00eda25f6d8bdca9929fc47084f
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/28/2018
---
# <a name="ras-gateway-high-availability"></a>RAS 게이트웨이 높은 공급 일

>적용 대상: Windows Server (세미콜론 연간 채널) Windows Server 2016

에 대 한 소프트웨어 정의 네트워킹 (SDN) RAS 넌 게이트웨이의 가용성 구성을 대 한 자세한 내용은이 항목을 사용할 수 있습니다.  
  
이 항목 다음 섹션에 포함 되어 있습니다.  
  
-   [RAS 게이트웨이 개요](#bkmk_overview)  
  
-   [게이트웨이 풀 개요](#bkmk_pools)  
  
-   [RAS 게이트웨이 배포 개요](#bkmk_deployment)  
  
-   [네트워크 컨트롤러와 RAS 게이트웨이 통합](#bkmk_integration)  
  
## <a name="bkmk_overview"></a>RAS 게이트웨이 개요  
조직 클라우드 서비스 공급자 (CSP) 또는 여러 명의 테 넌와 엔터프라이즈 인 경우 네트워크와 인터넷을 포함 하 여 가상 및 실제 네트워크 교통 경로 제공 하기 위해 넌 모드로 RAS 게이트웨이 배포할 수 있습니다.  
  
테 고객 네트워크 트래픽 테 넌 트 가상 네트워크 및 리소스를 경로 edge 게이트웨이로 RAS 게이트웨이 넌 모드에 배포할 수 있습니다.  
  
여러 개 RAS 게이트웨이 Vm 높은 가용성 및 장애 조치를 제공 하는 배포 하는 경우 게이트웨이 풀을 배포 합니다. 모든 게이트웨이 Windows Server 2012 r 2에 Vm 형성 게이트웨이 배포 논리 분리 약간 어렵게 단일 풀을 합니다.  Windows Server 2012 r 2 게이트웨이 VPN 연결 아래 활용 사이트 (S2S)에 사용할 수 있는 공간에에서는 Vm 게이트웨이 대 한 1:1 중복 배포를 제공 합니다.  
  
Windows Server 2016 년 논리 분리에 대 한 다양 한 종류의 될 수 있는 여러 게이트웨이 풀 기능을 제공 하는에서이 문제를 해결 합니다. 보다 효율적으로 장애 조치가 구성에 대 한 새로운 모드 M + N 중복 수 있게합니다.  
  
자세한 내용은 RAS 게이트웨이 대 한 개요를 참조 [RAS 게이트웨이](../../../../remote/remote-access/ras-gateway/RAS-Gateway.md)합니다.  
  
## <a name="bkmk_pools"></a>게이트웨이 풀 개요  
Windows Server 2016 게이트웨이 하나 이상의 풀에 배포할 수 있습니다.  
  
다음 그림에서는 게이트웨이 풀 가상 네트워크 사이의 교통 경로 제공 하는 다른 유형의 보여 줍니다.  
  
![RAS 게이트웨이 풀](../../../media/RAS-Gateway-High-Availability/ras_pools.png)  
  
각 풀에는 합니다.  
  
-   각 풀 M + N 중복입니다. 즉,는 보려고 ' 활성 게이트웨이 Vm 수 대기 게이트웨이 vm'n ' 번호로 백업 됩니다. / N (대기 게이트웨이) 값은 항상 M (활성 게이트웨이) 이하의 합니다.  
  
-   풀 게이트웨이 개별 기능을 수행할 수-인터넷 키 교환 버전 2 (IKEv2) S2S, 계층 3 l (3)와 일반 경로 캡슐화 (GRE)-또는 풀의 모든이 기능 수행할 수 있습니다.  
  
-   모든 풀 또는 풀의 하위 집합 단일 공개 IP 주소를 지정할 수 있습니다. 단일 IP 주소에서 클라우드에 연결 하는 모든 테 넌 있을 수 있기 때문에 공개 IP 주소를 사용 해야 할 수를 줄일 수 크게 지금 수행 합니다. 높은 가용성 부하 분산에 아래 섹션이 작동 하는 방법을 설명 합니다.  
  
-   조정할 수 있습니다 쉽게 게이트웨이 풀을 위나 아래로 추가 하거나 게이트웨이 Vm 풀에서 제거 하 여. 게이트웨이 추가 하거나 제거 풀에서 제공 되는 서비스를 방해 하지 않습니다. 추가 하 고 게이트웨이의 전체 풀 제거 수도 있습니다.  
  
-   여러 풀 하 고 풀에서 여러 게이트웨이에 단일 테의 연결 종료할 수 있습니다. 그러나 거주 종료에 연결 된 경우는 **모든** 게이트웨이 풀 입력 서로 등록할 수 없는 **모든** 형식이 나 개별 유형 게이트웨이 풀 합니다.  
  
또한 게이트웨이 풀 추가 시나리오를 사용 하도록 설정 하는 유연성을 제공 합니다.  
  
-   단일 테 풀-한 테에서 사용할 수 있도록 한 그룹을 만들 수 있습니다.  
  
-   파트너 (재판매인) 채널을 통해 클라우드 서비스를 판매 하는 경우 모든 재판매인에 대해 각기 다른 풀 만들 수 있습니다.  
  
-   여러 풀 용량 다른 있지만 같은 게이트웨이 기능을 제공할 수 있습니다. 예를 들어 높은 처리량 및 낮은 처리량 IKEv2 S2S 연결을 지원 게이트웨이 풀을 만들 수 있습니다.  
  
## <a name="bkmk_deployment"></a>RAS 게이트웨이 배포 개요  
다음 그림은 일반적인 클라우드 서비스 공급자 (CSP) 배포를 RAS 게이트웨이의 보여 줍니다.  
  
![RAS 게이트웨이 배포 개요](../../../media/RAS-Gateway-High-Availability/ras_csp_deploy.png)  
  
이 유형의 배포 게이트웨이 풀 뒤는 소프트웨어 부하 분산 (SLB),이 통해 전체 배포에 대 한 단일 공개 IP 주소를 지정 CSP 배포 됩니다. 여러 게이트웨이 풀-에 및 여러 게이트웨이 풀 내에 거주의 여러 게이트웨이의 연결 종료할 수 있습니다. 이 나와 위의 다이어그램 IKEv2 S2S 연결을 통해 하지만 같은 다른 게이트웨이 기능에 해당도 l 3와 GRE 게이트웨이 등 합니다.  
  
그림, MT BGP 장치가 BGP 인 RAS 넌 게이트웨이 합니다. 동적 경로 넌 BGP 사용 됩니다. 경로 거주에 대 한 곳에서-경로 반사 기 (RR) 라고 단일, 모든 테 사이트에 대 한 BGP 피어 링 처리 합니다. 자체 RR 풀의 모든 게이트웨이에서 배포 됩니다. 따라서 테 (데이터 경로) 연결에서 여러 게이트웨이 종료 되지만 경우가 테 (BGP 피어 링 지점-제어 경로)에 대 한 RR 게이트웨이 중 하나에 구성 됩니다.  
  
BGP 라우터가 중앙 집중식된 라우팅 개념 그릴 다이어그램에서 구분 됩니다. 게이트웨이 BGP 구현 제공 교통 경로 두 테 사이트 간의 경로 교통 지점으로 작동 하는 클라우드를 사용 하는 합니다. 이러한 BGP 기능 모든 게이트웨이 기능에 적용 됩니다.  
  
## <a name="bkmk_integration"></a>네트워크 컨트롤러와 RAS 게이트웨이 통합  
Windows Server 2016에 네트워크 컨트롤러 RAS 게이트웨이 완전히 통합 되어 있습니다. 네트워크 컨트롤러 및 RAS 게이트웨이 배포 되 면 네트워크 컨트롤러 다음과 같은 기능을 수행 합니다.  
  
-   게이트웨이 온천이 배포  
  
-   각 게이트웨이의 연결 테 구성  
  
-   게이트웨이 오류가 발생 했을 때 대기 게이트웨이의 흐르는 네트워크 교통 전환  
  
다음 섹션 RAS 게이트웨이가 컨트롤러 네트워크에 대 한 자세한 정보를 제공 합니다.  
  
-   [프로 비전 및 부하 분산 게이트웨이의 연결 (IKEv2, l 3, 및 GRE)](#bkmk_provisioning)  
  
-   [IKEv2 S2S에 대 한 높은 공급 일](#bkmk_ike)  
  
-   [GRE에 대 한 높은 공급 일](#bkmk_gre)  
  
-   [전달 게이트웨이 l 3에 대 한 높은 공급 일](#bkmk_l3)  
  
### <a name="bkmk_provisioning"></a>프로 비전 및 부하 분산 게이트웨이의 연결 (IKEv2, l 3, 및 GRE)  
거주 게이트웨이의 연결을 요청 하는 경우 네트워크 컨트롤러 요청 전송 됩니다. 네트워크 컨트롤러의 모든 풀의 모든 게이트웨이 하 고 각 풀의 용량을 포함 하 여 게이트웨이 풀의 모든에 대 한 정보로 구성 됩니다. 네트워크 컨트롤러 올바른 풀 및 연결에 대 한 게이트웨이 선택합니다. 이 옵션을이 선택 연결 대역폭을 요구를 기반으로 합니다. 네트워크 컨트롤러 "가장 잘 맞도록" 알고리즘을 사용 하 여 풀의 연결을 효율적으로 선택 합니다. 연결에 대 한 BGP 피어 링 지점은 테의 첫 번째 연결 하는 경우에이 이번에 지정 됩니다.  
  
네트워크 컨트롤러가 연결에 대 한 RAS 게이트웨이 선택한 후 네트워크 컨트롤러 구축 게이트웨이의 연결에 필요한 구성 합니다. 네트워크 컨트롤러 네트워크 번역 (NAT 주소) 규칙, SLB 풀에도 제공 연결이 IKEv2 S2S 연결, 이 NAT 규칙 SLB 풀에서 조정이 테 지정 게이트웨이의 연결 요청 합니다. 테 넌에 고유 하 게 사용할 수 있는 원본 IP으로 구분 됩니다.  
  
> [!NOTE]  
> GRE 연결과 l 3는 SLB 무시 하 고 지정된 RAS 게이트웨이으로 직접 연결 합니다.  이러한 연결은 원격 끝점 라우터 또는 다른 제 3 자 장치 올바르게 구성 해야 RAS 게이트웨이로 연결 필요 합니다.  
  
연결을 위해 사용 BGP 경로 BGP 피어 링는 RAS 게이트웨이-에서 시작 하 고 다음 온-프레미스 사이의 클라우드 경로 교환 게이트웨이 합니다. 네트워크 컨트롤러 BGP에서 감지 하는 (또는 BGP 사용 하지 않는 경우 정적으로 구성 된 경로 게) 경로 전송 됩니다. 네트워크 컨트롤러 다음 Vm 테 설치 되어 있는 Hyper-v 호스트 나타날 때까지 아래로 경로 plumbs 합니다. 이 시점 테 교통 올바른 온-프레미스 사이트에 라우팅되지 수 있습니다. 네트워크 컨트롤러 게이트웨이 위치를 지정 하는 연결 된 네트워크 가상화 Hyper-v 정책도 만들고 Hyper-v 호스트 나타날 때까지 아래로 plumbs 합니다.  
  
### <a name="bkmk_ike"></a>IKEv2 S2S에 대 한 높은 공급 일  
풀에서 RAS 게이트웨이 연결 및 다른 소유 BGP 피어 링으로 구성 됩니다. 모든 풀에 보려고 ' 활성 게이트웨이 및 ' n ' 대기 게이트웨이 합니다.  
  
네트워크 컨트롤러 게이트웨이가 장애 다음과 같은 방법으로 처리합니다.  
  
-   네트워크 컨트롤러 지속적으로 핑 게이트웨이가 모든 풀 및 수 실패 하는 게이트웨이 검색 또는 실패 합니다. 네트워크 컨트롤러 다음과 같은 유형의 RAS 게이트웨이 오류를 검색할 수 있습니다.  
  
    -   RAS 게이트웨이 VM 실패  
  
    -   Hyper-v 호스트 RAS 게이트웨이 실행 되 고 있는 실패  
  
    -   RAS 게이트웨이 서비스가 실패  
  
    네트워크 컨트롤러 모든 배포 활성 게이트웨이 구성을 저장합니다. 연결 설정 및 라우팅 설정을 구성 구성 됩니다.  
  
-   게이트웨이 실패 때 테 연결 하는 다른 게이트웨이에 있는 있지만 해당 RR 실패 게이트웨이에 있는 뿐 아니라 테 연결 게이트웨이에 영향을 합니다. 이전 보다는 후자의 연결의 아래쪽에 있습니다. 네트워크 컨트롤러 실패 게이트웨이 발견 하면 다음과 같은 작업을 수행 합니다.  
  
    -   영향을 받는 연결 경로 컴퓨팅 호스트에서 제거합니다.  
  
    -   이러한 호스트에 Hyper-v 네트워크 가상화 정책을 제거합니다.  
  
    -   대기 게이트웨이 선택 되 고, 현재 게이트웨이로 변환 게이트웨이 구성 합니다.  
  
    -   새 게이트웨이의 연결 가리키도록 SLB 풀의 NAT 매핑 변경 합니다.  
  
-   동시에 구성 새 활성 게이트웨이에서 올라오는으로 IKEv2 S2S 연결과 BGP 피어 링은 다시 설정 합니다. 클라우드 게이트웨이 또는 온-프레미스 게이트웨이의 연결 및 BGP 피어 링을 시작할 수 있습니다. 게이트웨이 자신의 경로 새로 고칩니다 및 네트워크 컨트롤러에 게 보내세요. 네트워크 컨트롤러 학습 게이트웨이에서 발견 된 새로운 경로 후 네트워크 컨트롤러 경로 및 관련된 Hyper-v 네트워크 가상화 정책을 보냅니다 Hyper-v 호스트 오류 영향 테 넌 Vm 있는. 네트워크 컨트롤러가 활동은 비슷한 새 연결 설정의 경우에만 발생 크게 합니다.  
  
### <a name="bkmk_gre"></a>GRE에 대 한 높은 공급 일  
네트워크 컨트롤러-비롯 하 여 오류 감지, 복사 연결 및 대기 게이트웨이의 라우팅 구성을, BGP/고정 재구성 컴퓨팅 호스트에 Hyper-v 네트워크 가상화 정책 및 영향을 받는 연결 (의 인출을 포함 하 고에 경로 배관 다시 계산 호스트 및 BGP 다시 피어 링), 경로 장애 조치-RAS 게이트웨이가 장애 조치 응답 하는 과정 GRE 게이트웨이 및 연결에 대 한 같습니다. 그러나 다시 연결 GRE 연결 수행 다르게 되며 높은 가용성 솔루션 GRE에 대 한 몇 가지 추가 요구 사항이.  
  
![GRE에 대 한 높은 공급 일](../../../media/RAS-Gateway-High-Availability/ras_ha.png)  
  
게이트웨이 배포 당시 모든 RAS 게이트웨이 VM (담그고) 동적 IP 주소를 할당 됩니다. 또한, 모든 게이트웨이 VM도 사용 가능 하도록 GRE 가상 IP 주소 (VIP) 지정 됩니다. 비 GRE 풀 아니라 게이트웨이 GRE 연결을 사용할 수 있는 풀에 Vip 지정 됩니다. 할당 된 Vip BGP 그러면 클라우드 실제 네트워크에 Vip 추가로 알립니다를 사용 하 여 랙 (에) 스위치 맨 광고 됩니다. 따라서 게이트웨이 연결할 수 있는 원격 라우터 또는 제 3 자 장치에서 GRE 연결의 다른 쪽 끝 있는 합니다. 이 BGP 피어 링은 거래소 테 경로의 대 한 피어 링 테 수준 BGP 다릅니다.  
  
GRE 연결 프로 비전 당시 네트워크 컨트롤러 선택 게이트웨이 선택한 게이트웨이의 GRE endpoint 구성 되 고, 할당 된 게이트웨이의 VIP 주소를 반환 합니다. 이 VIP 원격 라우터에 GRE 터널 주소를 대상으로 구성 됩니다.  
  
게이트웨이 오류가 발생 하면 네트워크 컨트롤러 실패 게이트웨이 및 기타 구성 데이터의 VIP 주소 대기 게이트웨이에 복사 합니다. 대기 게이트웨이 활성화 되 면 해당에 스위치를 VIP 알립니다 하 고 실제 네트워크에 추가 합니다. 원격 라우터 계속 GRE 터널 같은 VIP에 연결 하 고 라우팅 infrastructure는 패킷이 새 활성 게이트웨이의 되도록 합니다.  
  
### <a name="bkmk_l3"></a>전달 게이트웨이 l 3에 대 한 높은 공급 일  
Hyper-v 네트워크 가상화 l 3 전달 게이트웨이 데이터 센터에 물리적 인프라와 Hyper-v 네트워크 가상화 클라우드에서 가상화 infrastructure 사이의 다리는 합니다. 각 테 넌 l 3 전달 게이트웨이에서 테의 실제 네트워크와 연결을 자체 VLAN tagged 논리 네트워크를 사용합니다.  
  
새 테 새로운 l 3 게이트웨이 만들면 네트워크 컨트롤러 게이트웨이 서비스 관리자 사용 가능한 게이트웨이 VM 선택 하 고 (테의 VLAN tagged 논리 네트워크에서) 가용성 고객 주소 (캐나다) 공간이 IP 주소를 가진 테 인터페이스를 새로 구성 합니다. IP 주소 원격 (실제 네트워크) 게이트웨이에 피어 IP 주소도 사용 되 고 테의 Hyper-v 네트워크 가상화 네트워크에 연결 하려면 다음 홉.  
  
달리 IPsec 또는 GRE 네트워크 연결에 전환 하지 배웁니다 테의 VLAN tagged 네트워크 동적으로 합니다. 테의 VLAN tagged 네트워크에 대 한 경로 스위치 모든 중간 스위치와 라우터 실제 인프라와 끝 연결을 위해 게이트웨이 사이 구성 해야 합니다.  다음은 아래에 표시 된 대로 예제 CSP 가상 네트워크 구성 합니다.  
  
|네트워크|서브넷|VLAN ID|기본 게이트웨이|  
|-----------|----------|-----------|-------------------|  
|Contoso l 3 논리 네트워크|10.127.134.0/24|1001|10.127.134.1|  
|Woodgrove l 3 논리 네트워크|10.127.134.0/24|1002|10.127.134.1|  
  
다음은 테 게이트웨이 구성 예제 아래에 표시 된 대로 합니다.  
  
|테 이름|L 3 게이트웨이 IP 주소|VLAN ID|피어 IP 주소|  
|---------------|-------------------------|-----------|-------------------|  
|Contoso|10.127.134.50|1001|10.127.134.55|  
|Woodgrove|10.127.134.60|1002|10.127.134.65|  
  
이러한 구성 CSP 데이터 센터에 그림은 다음과가 같습니다.  
  
![전달 게이트웨이 l 3에 대 한 높은 공급 일](../../../media/RAS-Gateway-High-Availability/ras_fwdgw.png)  
  
게이트웨이 오류, 오류 검색 및 게이트웨이 전달 된 l 3의 컨텍스트에서 게이트웨이가 장애 조치 프로세스는 IKEv2 및 GRE RAS 게이트웨이 프로세스가 유사 합니다. 차이점이 외부 IP 주소를 처리 하는 방식에서입니다.  
  
비정상적인 게이트웨이 VM 상태가 되 면 네트워크 컨트롤러 풀에서 대기 게이트웨이 중 하나를 선택 하 고 다시 대기 게이트웨이의 경로 및 네트워크 연결을 제공 합니다. 연결을 3 전달 게이트웨이 매우 이동 하는 동안 캐나다의 사용 가능한 공간이 IP 주소에서 테의 캘리포니아 공간 BGP IP 주소와 함께 새로운 게이트웨이 VM 이동 합니다.  
  
새 게이트웨이의 VM 장애 조치 중 l 3 피어 링 IP 주소를 이동 있으므로 원격 물리적 인프라는이 IP 주소에 연결 하 고 이후, Hyper-v 네트워크 가상화 작업에 연결할 수 다시입니다. BGP 동적 경로 BGP IP 주소 새로운 게이트웨이 VM에서으로 이동할 때 캘리포니아 공간에 대 한 원격 BGP 라우터 피어 링을 다시 설정 하 고 모든 Hyper-v 네트워크 가상화 경로 다시 알아보세요 수 있습니다.  
  
> [!NOTE]  
> 에 스위치와 중간 라우터가 모두 테 통신을 위해 VLAN tagged 논리 네트워크를 사용 하기 위해 별도로 구성 해야 합니다. 또한 l 3 장애 조치 이런 방법으로 구성 된 랙만 제한 됩니다. 이 인해 l 3 게이트웨이 풀 신중 하 게 구성 되어야 하 고 수동으로 구성 별도로 완료 해야 합니다.  
  


