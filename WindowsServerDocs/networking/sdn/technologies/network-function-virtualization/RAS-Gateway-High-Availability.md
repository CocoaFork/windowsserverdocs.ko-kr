---
title: RAS 게이트웨이 고가용성
description: 에 대 한 네트워킹 SDN (소프트웨어) Windows Server 2016에서 다중 테 넌 트 RAS 게이트웨이 고가용성 구성에 대해 자세히 알아보려면이 항목에서는 사용할 수 있습니다.
manager: brianlic
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: networking-sdn
ms.tgt_pltfrm: na
ms.topic: get-started-article
ms.assetid: 34d826c9-65bc-401f-889d-cf84e12f0144
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 8ce515ceeb7ab6989ef18055f312983a6518a1a1
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59847764"
---
# <a name="ras-gateway-high-availability"></a>RAS 게이트웨이 고가용성

>적용 대상: Windows Server (반기 채널), Windows Server 2016

에 대 한 소프트웨어 정의 네트워킹 (SDN) 다중 테 넌 트 RAS 게이트웨이 고가용성 구성에 대해 자세히 알아보려면이 항목에서는 사용할 수 있습니다.  
  
이 항목에는 다음 섹션이 수록되어 있습니다.  
  
-   [RAS Gateway 개요](#bkmk_overview)  
  
-   [게이트웨이 풀 개요](#bkmk_pools)  
  
-   [RAS 게이트웨이 배포 개요](#bkmk_deployment)  
  
-   [네트워크 컨트롤러를 사용 하 여 RAS 게이트웨이 통합](#bkmk_integration)  
  
## <a name="bkmk_overview"></a>RAS Gateway 개요  
클라우드 서비스 공급자 (CSP) 또는 여러 테 넌 트를 사용 하 여 엔터프라이즈 조직의 경우에 인터넷을 포함 하 여, 가상 및 실제 네트워크 간의 네트워크 트래픽 라우팅을 제공 하기 위해 다중 테 넌 트 모드로 RAS 게이트웨이 배포할 수 있습니다.  
  
테 넌 트 가상 네트워크 및 리소스를 테 넌 트 고객 네트워크 트래픽을 라우팅하는 edge 게이트웨이로 RAS 게이트웨이 다중 테 넌 트 모드로 배포할 수 있습니다.  
  
게이트웨이 풀을 배포 하는 고가용성 및 장애 조치를 제공 하는 RAS 게이트웨이 Vm의 여러 인스턴스를 배포 합니다. 모든 게이트웨이 Windows Server 2012 R2의 Vm 구성 어려울 게이트웨이 배포의 논리적 분리를 수행 하는 단일 풀.  Windows Server 2012 R2 gateway는 게이트웨이 Vm이 VPN 연결으로 인해 언더 사이트 및 사이트 간 (S2S)에 대 한 사용 가능한 용량 사용률에 대 한 1:1 중복 배포를 제공 합니다.  
  
이 문제는 여러 게이트웨이 풀-논리적 분리에 대 한 다른 형식의 수를 제공 하는 Windows Server 2016에서 해결 되었습니다. M + N 중복성의 새 모드 보다 효율적으로 장애 조치 구성을 허용합니다.  
  
RAS 게이트웨이에 대 한 자세한 개요 정보를 참조 하세요 [RAS 게이트웨이](../../../../remote/remote-access/ras-gateway/RAS-Gateway.md)합니다.  
  
## <a name="bkmk_pools"></a>게이트웨이 풀 개요  
Windows Server 2016에서 하나 이상의 풀의 게이트웨이 배포할 수 있습니다.  
  
다음 그림에서는 다양 한 유형의 가상 네트워크 간의 트래픽 라우팅을 제공 하는 게이트웨이 풀을 보여 줍니다.  
  
![RAS 게이트웨이 풀](../../../media/RAS-Gateway-High-Availability/ras_pools.png)  
  
각 풀에는 다음 속성이 있습니다.  
  
-   각 풀은 M + N 중복입니다. 즉는 여기 ' 활성 게이트웨이 Vm 수는 ' n ' 수가 대기 게이트웨이 Vm으로 백업 합니다. N (대기 게이트웨이)의 값은 항상 M (활성 게이트웨이) 보다 작거나 합니다.  
  
-   풀에 개별 게이트웨이 함수를 수행할 수 있습니다-Internet Key Exchange version 2 (IKEv2) S2S, (L3) 계층 3 및 캡슐화 GRE (Generic Routing)-또는 풀 이러한 모든 함수를 수행할 수 있습니다.  
  
-   모든 풀 또는 풀의 하위 집합을 단일 공용 IP 주소를 할당할 수 있습니다. 단일 IP 주소에서 클라우드로 연결 된 모든 테 넌 트를 가질 수 있기 때문에 사용 해야 하는 공용 IP 주소의 수를 줄입니다 따라서 크게 수행. 고가용성 및 부하 분산 아래 섹션이 작동 하는 방법을 설명 합니다.  
  
-   쉽게 확장할 수 있습니다 게이트웨이 풀 위로 또는 아래로 추가 하거나 풀에서 게이트웨이 Vm을 제거 합니다. 게이트웨이 추가 또는 제거는 풀에서 제공 되는 서비스를 방해 하지 않도록 합니다. 또한 추가 및 게이트웨이 전체 풀을 제거할 수 있습니다.  
  
-   단일 테 넌 트의 연결 여러 풀 및 풀에 여러 게이트웨이 종료할 수 있습니다. 그러나 테 넌 트에 연결을 종료 하는 경우는 **모든** 게이트웨이 풀 입력 다른 구독할 수 없습니다 **모든** 형식 또는 개별 유형의 게이트웨이 풀 합니다.  
  
또한 게이트웨이 풀 추가 시나리오를 사용 하도록 설정 하는 유연성을 제공 합니다.  
  
-   단일 테 넌 트 풀-단일 테 넌 트 사용에 대 한 하나의 풀을 만들 수 있습니다.  
  
-   파트너 (대리점) 채널을 통해 클라우드 서비스를 판매 하는 경우에 모든 대리점에 대 한 별도의 풀 집합을 만들 수 있습니다.  
  
-   여러 풀 다르게 지정 하지만 동일한 게이트웨이 기능을 제공할 수 있습니다. 예를 들어, 높은 처리량과 낮은 처리량 IKEv2 S2S 연결을 지 원하는 게이트웨이 풀을 만들 수 있습니다.  
  
## <a name="bkmk_deployment"></a>RAS 게이트웨이 배포 개요  
다음 그림에서는 일반적인 클라우드 서비스 공급자 (CSP) RAS 게이트웨이 배포를 보여 줍니다.  
  
![RAS 게이트웨이 배포 개요](../../../media/RAS-Gateway-High-Availability/ras_csp_deploy.png)  
  
이 유형의 배포를 사용 하 여 게이트웨이 풀 뒤를 부하 분산 장치 SLB (소프트웨어)를 CSP 전체 배포를 위한 단일 공용 IP 주소를 할당할 수 있도록 하는 배포 됩니다. 테 넌 트에 여러 게이트웨이 연결이-여러 게이트웨이 풀 및 풀 내의 여러 게이트웨이에서 종료할 수 있습니다. 위의 다이어그램에서 IKEv2 S2S 연결을 통해 설명 되어 있습니다 이지만 동일한 다른 게이트웨이 기능을 적용할도 GRE 및 L3 게이트웨이 같은 있습니다.  
  
그림에서 MT BGP 장치는 BGP 사용 하 여 RAS 다중 테 넌 트 게이트웨이입니다. 다중 테 넌 트 BGP 동적 라우팅에 사용 됩니다. 테 넌 트에 대 한 라우팅는 중앙 집중식-이라는 경로 reflector (RR), 단일 지점, 모든 테 넌 트 사이트에 대 한 BGP 피어 링을 처리 합니다. 풀의 모든 게이트웨이 자체는 RR 분산 됩니다. 그러면 여기서 테 넌 트 (데이터 경로)의 연결 여러 게이트웨이에서 종료 이지만 테 넌 트 (BGP 피어 링 지점-제어 경로)에 대 한 RR 게이트웨이 중 하나 에서만 구성 됩니다.  
  
BGP 라우터가 중앙 집중식된 라우팅 개념을 설명 하는 데 다이어그램에서 분리 됩니다. 게이트웨이 BGP 구현도 제공 전송 라우팅을 두 테 넌 트 사이트 간 라우팅에 대 한 전송 지점으로 작동 하도록 클라우드 수 있습니다. 이러한 BGP 기능 게이트웨이 모든 함수에 적용 됩니다.  
  
## <a name="bkmk_integration"></a>네트워크 컨트롤러를 사용 하 여 RAS 게이트웨이 통합  
RAS 게이트웨이 Windows Server 2016에서 네트워크 컨트롤러와 완전히 통합 됩니다. RAS 게이트웨이 및 네트워크 컨트롤러를 배포할 때 네트워크 컨트롤러는 다음 기능을 수행 합니다.  
  
-   게이트웨이 풀 배포  
  
-   각 게이트웨이 연결 테 넌 트 구성  
  
-   게이트웨이 오류가 발생할 경우 대기 게이트웨이로 흐르는 네트워크 트래픽을 전환  
  
다음 섹션에서는 RAS 게이트웨이 및 네트워크 컨트롤러에 대 한 자세한 정보를 제공 합니다.  
  
-   [프로 비전 및 부하 분산 (IKEv2, L3, 및 GRE) 게이트웨이 연결](#bkmk_provisioning)  
  
-   [IKEv2 S2S에 대 한 고가용성](#bkmk_ike)  
  
-   [GRE에 대 한 고가용성](#bkmk_gre)  
  
-   [에 대 한 고가용성 L3 게이트웨이 전달 합니다.](#bkmk_l3)  
  
### <a name="bkmk_provisioning"></a>프로 비전 및 부하 분산 (IKEv2, L3, 및 GRE) 게이트웨이 연결  
테 넌 트 게이트웨이 연결을 요청 하면 요청은 네트워크 컨트롤러에 전송 됩니다. 네트워크 컨트롤러는 모든 풀의 모든 게이트웨이 및 각 풀의 용량을 포함 하 여 게이트웨이 풀의 모든 정보를 사용 하 여 구성 됩니다. 네트워크 컨트롤러에 올바른 풀 및 연결에 대 한 게이트웨이 선택합니다. 이 옵션을이 선택 연결의 대역폭 요구 사항을 기반으로 합니다. 네트워크 컨트롤러 "최적" 알고리즘을 사용 하 여 풀에서 연결을 효율적으로 선택. 연결에 대 한 BGP 피어 링 지점 테 넌 트의 첫 번째 연결 인 경우에이 이번에 지정 됩니다.  
  
연결에 대 한 RAS 게이트웨이 선택 하는 네트워크 컨트롤러, 후 네트워크 컨트롤러에 게이트웨이 연결에 대 한 필요한 구성을 프로 비전 합니다. 네트워크 컨트롤러 SLB 풀에 대 한 네트워크 주소 변환 (NAT) 규칙 또한 프로 비전 연결 IKEv2 S2S 연결, 인 경우 이 NAT 규칙 SLB 풀에서 지정 된 게이트웨이를 테 넌 트의 연결 요청을 전달합니다. 고유 하 게 예상 되는 원본 IP, 테 넌 트 구분 됩니다.  
  
> [!NOTE]  
> GRE 및 L3 연결 SLB를 무시 하 고 지정 된 RAS 게이트웨이와 직접 연결 합니다.  이러한 연결에는 원격 끝점이 라우터 (또는 다른 타사 장치)를 제대로 구성 해야 RAS 게이트웨이 사용 하 여 연결에 필요 합니다.  
  
연결에 BGP 라우팅을 사용 하도록 설정 하 고 RAS 게이트웨이-시작 BGP 피어 링 경로 온-프레미스와 클라우드 간에 교환 되는 경우 게이트웨이. 경로 BGP에 의해 학습 됩니다 (또는 정적으로 구성 된 경로 BGP를 사용 하지 않는 경우)는 네트워크 컨트롤러에 전송 됩니다. 네트워크 컨트롤러는 테 넌 트 Vm이 설치 된 Hyper-v 호스트까지 경로 다음 트리거되 합니다. 이 시점에서 테 넌 트 트래픽은 올바른 온-프레미스 사이트로 라우팅할 수 있습니다. 네트워크 컨트롤러도 게이트웨이 위치를 지정 하는 연결 된 Hyper-v 네트워크 가상화 정책을 만들고 Hyper-v 호스트까지 트리거되 하 합니다.  
  
### <a name="bkmk_ike"></a>IKEv2 S2S에 대 한 고가용성  
RAS 게이트웨이 풀의 연결과 다른 테 넌 트의 BGP 피어 링으로 구성 됩니다. 모든 풀에는 여기 ' 활성 게이트웨이 및 ' n ' 대기 게이트웨이.  
  
네트워크 컨트롤러는 다음과 같은 방식으로 게이트웨이 오류를 처리합니다.  
  
-   네트워크 컨트롤러 지속적으로 모든 풀에 있습니다 게이트웨이 ping은 실패 한 게이트웨이 검색 하거나 실패 합니다. 네트워크 컨트롤러는 다음과 같은 유형의 RAS 게이트웨이 오류를 감지할 수 있습니다.  
  
    -   RAS 게이트웨이 VM 실패  
  
    -   RAS 게이트웨이 실행 되 고 있는 Hyper-v 호스트의 실패  
  
    -   RAS 게이트웨이 서비스 오류  
  
    네트워크 컨트롤러 배포 된 모든 활성 게이트웨이 구성을 저장합니다. 연결 설정 및 라우팅 설정을 구성 합니다.  
  
-   게이트웨이 오류가 발생 하면 영향을 미치기 게이트웨이에서 테 넌 트 연결 뿐만 아니라 다른 게이트웨이에 있는 해당 RR에 있지만 실패 한 게이트웨이 테 넌 트 연결 합니다. 두 번째 연결의 가동 중지 시간을 사용 하면 이전 보다 작습니다. 네트워크 컨트롤러에서 실패 한 게이트웨이 감지 하면 다음 작업을 수행 합니다.  
  
    -   계산 호스트에서 영향을 받는 연결의 경로 제거합니다.  
  
    -   이 호스트의 Hyper-v 네트워크 가상화 정책을 제거합니다.  
  
    -   대기 게이트웨이 선택 하 고 활성 게이트웨이로 변환 게이트웨이 구성 합니다.  
  
    -   새 게이트웨이에 대 한 연결을 가리키도록 SLB 풀에 NAT 매핑을 변경 합니다.  
  
-   동시에 구성을 새 활성 게이트웨이에 나타난 대로 IKEv2 S2S 연결 및 BGP 피어 링은 다시 설정 합니다. 클라우드 게이트웨이 또는 온-프레미스 게이트웨이 연결 및 BGP 피어 링을 시작할 수 있습니다. 게이트웨이 해당 경로 새로 고치고에 네트워크 컨트롤러를 보냅니다. 네트워크 컨트롤러 게이트웨이에서 검색 된 새 경로 학습 한 후 네트워크 컨트롤러 보냅니다 경로 및 연결 된 Hyper-v 네트워크 가상화 정책을 Hyper-v 호스트에 오류 영향을 받는 테 넌 트의 Vm이 상주 합니다. 이 네트워크 컨트롤러 작업이 유사한 새 연결 설정의 경우에만 발생 규모가 큰 합니다.  
  
### <a name="bkmk_gre"></a>GRE에 대 한 고가용성  
네트워크 컨트롤러-실패 감지를 포함 하 여, 연결을 복사 및 대기 게이트웨이로 장애 조치의 영향을 받는 연결의 BGP/정적 라우팅 구성이 라우팅에서 RAS 게이트웨이 장애 조치 응답의 프로세스 (음수의 포함 및 경로의 배관 다시 계산 호스트 및 BGP 다시 피어 링), 계산 호스트-Hyper-v 네트워크 가상화 정책 재구성은 GRE 게이트웨이 및 연결에 대해 동일 합니다. 그러나 GRE 연결 재설정이 발생 다르게 하며 GRE에 대 한 고가용성 솔루션은 몇 가지 추가 요구 사항이 있습니다.  
  
![GRE에 대 한 고가용성](../../../media/RAS-Gateway-High-Availability/ras_ha.png)  
  
게이트웨이 배포 시 모든 RAS 게이트웨이 VM는 동적 IP 주소 (DIP)를 할당 됩니다. 또한 모든 게이트웨이 VM GRE 고가용성에 대 한 가상 IP 주소 (VIP)에 할당 됩니다. Vip는 비 GRE 풀 아니라 GRE 연결을 허용할 수는 풀의 게이트웨이만 할당 됩니다. 할당 된 Vip는 다음 추가 Vip를 클라우드 물리적 네트워크에 보급 하는 BGP를 사용 하 여 tor () 스위치의 맨 위에 보급 됩니다. 이렇게 하면 게이트웨이 연결할 수 원격 라우터 또는 타사 장치에서 GRE 연결의 반대쪽 상주 합니다. 이 BGP 피어 링 하는 것은 테 넌 트 수준 BGP exchange 테 넌 트 경로 대 한 피어 링 다릅니다.  
  
GRE 연결 프로 비전 시 네트워크 컨트롤러 게이트웨이 선택, 선택한 게이트웨이에서 GRE 끝점을 구성 및 다시 할당 된 게이트웨이의 VIP 주소를 반환 합니다. 그런 다음이 VIP은 원격 라우터에서 GRE 터널 주소를 대상으로 구성 됩니다.  
  
게이트웨이 실패 하면 네트워크 컨트롤러 대기 게이트웨이를 실패 한 게이트웨이 및 기타 구성 데이터의 VIP 주소를 복사 합니다. 대기 게이트웨이 활성화 하는 경우 해당 TOR 스위치에 VIP를 보급 하 고 실제 네트워크에 추가 합니다. 원격 라우터 계속 동일한 VIP에 GRE 터널 연결 및 라우팅 인프라는 패킷이 새 활성 게이트웨이를 확인 합니다.  
  
### <a name="bkmk_l3"></a>에 대 한 고가용성 L3 게이트웨이 전달 합니다.  
Hyper-v 네트워크 가상화 L3 전달 게이트웨이 데이터 센터의 물리적 인프라와 Hyper-v 네트워크 가상화 클라우드의 가상화 된 인프라 간에 다리입니다. L3 전달 게이트웨이 다중 테 넌 트에 각 테 넌 트 자체 VLAN 태그가 지정 된 논리 네트워크를 사용 하 여 테 넌 트의 실제 네트워크와의 연결에 대 한 합니다.  
  
새 테 넌 트를 새로운 L3 게이트웨이 만들 때 네트워크 컨트롤러 게이트웨이 서비스 관리자는 사용 가능한 게이트웨이 VM을 선택 하 고 (테 넌 트의 VLAN 태그가 지정 된 논리 네트워크에서에서 항상 사용 가능한 CA (고객 주소) 공간 IP 주소를 사용 하 여 새 테 넌 트 인터페이스 구성 ). IP 주소 (실제 네트워크) 원격 게이트웨이에서 피어 IP 주소로 사용 됩니다 이며 테 넌 트의 Hyper-v 네트워크 가상화 네트워크에 연결할 다음 홉입니다.  
  
IPsec 나 GRE 네트워크 연결과 달리 TOR 스위치는 유용한 정보를 얻지 테 넌 트의 VLAN 태그가 지정 된 네트워크 동적으로 합니다. 테 넌 트의 VLAN 태그가 지정 된 네트워크 라우팅을 TOR 스위치 및 모든 중간 스위치 및 라우터가 종단 간 연결을 보장 하는 게이트웨이의 실제 인프라 사이 구성 해야 합니다.  다음은 아래 그림에서 보듯이 CSP 가상 네트워크 구성 예제입니다.  
  
|네트워크|서브넷|VLAN ID|기본 게이트웨이|  
|-----------|----------|-----------|-------------------|  
|Contoso L3 논리 네트워크|10.127.134.0/24|1001|10.127.134.1|  
|Woodgrove L3 논리 네트워크|10.127.134.0/24|1002|10.127.134.1|  
  
아래 그림에 표시 된 대로 다음은 예제 테 넌 트 게이트웨이 구성 합니다.  
  
|테 넌 트 이름|L3 게이트웨이 IP 주소|VLAN ID|피어 IP 주소|  
|---------------|-------------------------|-----------|-------------------|  
|Contoso|10.127.134.50|1001|10.127.134.55|  
|Woodgrove|10.127.134.60|1002|10.127.134.65|  
  
다음은 CSP 데이터 센터에서 이러한 구성을 보여 줍니다.  
  
![에 대 한 고가용성 L3 게이트웨이 전달 합니다.](../../../media/RAS-Gateway-High-Availability/ras_fwdgw.png)  
  
게이트웨이 오류, 오류 감지 및 전달 게이트웨이에 L3의 컨텍스트에서 게이트웨이 장애 조치 프로세스 IKEv2 및 GRE RAS 게이트웨이에 대 한 프로세스 비슷합니다. 차이점은 외부 IP 주소를 처리 하는 방식에서입니다.  
  
게이트웨이 VM 상태 비정상 되 면 네트워크 컨트롤러는 풀에서 대기 게이트웨이 중 하나를 선택 하 고 네트워크 연결 및 대기 게이트웨이에서 라우팅를 다시 프로 비전. 항상 연결 L3 전달 게이트웨이 이동 하는 동안 사용할 수 있는 CA 공간 IP 주소가 테 넌 트의 CA 공간 BGP IP 주소와 함께 새 게이트웨이 VM에도 이동 됩니다.  
  
L3 피어 링 IP 주소가 장애 조치 하는 동안 새 게이트웨이 VM 이동 하기 때문에 원격 실제 인프라는이 IP 주소에 연결 하 고 이후에 Hyper-v 네트워크 가상화 작업에 도달 하는 일을 할 다시 합니다. BGP 동적 라우팅, BGP IP 주소는 VM에 새 게이트웨이 이동 하는 CA 공간으로 원격 BGP 라우터 피어 링을 다시 설정 하 고 다시 모든 Hyper-v 네트워크 가상화 경로 알아봅니다.  
  
> [!NOTE]  
> TOR 스위치 및 모든 중간 라우터의 테 넌 트 통신을 위한 VLAN 태그가 지정 된 논리 네트워크를 사용 하려면 별도로 구성 해야 합니다. 또한 L3 장애 조치는 이러한 방식으로 구성 된 랙은 제한 됩니다. 이 인해 L3 게이트웨이 풀을 신중 하 게 구성 되어야 하 고 개별적으로 수동 구성을 완료 해야 합니다.  
  


