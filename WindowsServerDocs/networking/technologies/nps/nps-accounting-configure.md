---
title: 네트워크 정책 서버 계정 구성
description: 이 항목에서는 텍스트 파일 및 Windows Server 2016에서 네트워크 정책 서버에 대 한 로깅 하는 SQL Server에 대 한 정보를 제공 합니다.
manager: dougkim
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: dfde2e21-f3d5-41e8-8492-cb3f0d028afb
ms.author: pashort
author: shortpatti
ms.date: 05/25/2018
ms.openlocfilehash: c732a9f42d942ad579468d1dd15d30324d6fea87
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59839704"
---
# <a name="configure-network-policy-server-accounting"></a>네트워크 정책 서버 계정 구성

네트워크 정책 서버에 대 한 로깅에 세 종류가 \(NPS\):

- **이벤트 로깅**합니다. 감사 및 문제해결 연결 시도에 주로 사용 합니다. NPS 콘솔에서 NPS 속성을 확보 하 여 로깅 NPS 이벤트를 구성할 수 있습니다.

- **로컬 파일에 사용자 인증 및 계정 요청 로깅**합니다. 연결 분석을 위해 주로 사용 및 청구 목적으로 합니다. 또한 유용한 보안 조사 도구로 공격을 받은 후 악의적인 사용자의 활동을 추적 하는 메서드를 사용 하 여 제공 하기 때문에 합니다. 계정 구성 마법사를 사용 하 여 로컬 파일 로깅을 구성할 수 있습니다.

- **Microsoft SQL Server XML 규격 데이터베이스에 사용자 인증 및 계정 요청 로깅**합니다. 하나의 데이터 원본이 NPS를 실행 하는 여러 서버를 허용 하는 데 사용 합니다. 관계형 데이터베이스 사용의 이점을 제공 합니다. 계정 구성 마법사를 사용 하 여 SQL Server 로깅을 구성할 수 있습니다.

## <a name="use-the-accounting-configuration-wizard"></a>계정 구성 마법사를 사용 합니다.

계정 구성 마법사를 사용 하 여 다음 네 가지 계정 설정에서 구성할 수 있습니다.

- **SQL 로그인에**합니다. 이 설정을 사용 하 여 연결 하 여 SQL server 계정 데이터를 전송 하는 NPS를 허용 하는 SQL Server에 데이터 연결을 구성할 수 있습니다. 또한 마법사 데이터베이스 NPS SQL 서버 로깅을 사용 하 여 호환 되는지 확인 하는 SQL Server에서 데이터베이스를 구성할 수 있습니다.
- **텍스트 로깅에**합니다. 이 설정을 사용 하 여 텍스트 파일에 회계 데이터를 기록 하는 NPS를 구성할 수 있습니다.
- **로깅 병렬**합니다. 이 설정을 사용 하 여 SQL Server 데이터 연결 및 데이터베이스를 구성할 수 있습니다. 텍스트 파일 로깅 NPS 텍스트 파일 및 SQL Server 데이터베이스를 동시에 기록 되도록 구성할 수 있습니다. 
- **백업 사용 하 여 SQL 로깅**합니다. 이 설정을 사용 하 여 SQL Server 데이터 연결 및 데이터베이스를 구성할 수 있습니다. 또한 SQL Server 로깅 실패 하는 경우 NPS를 사용 하는 텍스트 파일 로깅을 구성할 수 있습니다.

이러한 설정 외에도 텍스트 로깅 및 SQL Server 로깅 NPS 계속 로깅이 실패할 경우 연결 요청을 처리할지 여부를 지정할 수 있습니다. 이 지정할 수 있습니다는 **로깅 오류 동작 섹션** SQL server 로깅 속성에서 및 회계 구성 마법사를 실행 하는 동안 로컬 파일 로깅 속성입니다.

### <a name="to-run-the-accounting-configuration-wizard"></a>계정 구성 마법사를 실행 하려면

계정 구성 마법사를 실행 하려면 다음 단계를 수행 합니다.

1. NPS 콘솔 또는 NPS Microsoft Management Console (MMC) 스냅인을 엽니다.
2. 콘솔 트리에서 **Accounting**합니다.
3. 세부 정보 창에서의 **Accounting**, 클릭 **회계 구성**합니다.

## <a name="configure-nps-log-file-properties"></a>NPS 로그 파일 속성 구성

네트워크 정책 (NPS 서버)에 전화 접속 사용자 서비스 RADIUS (Remote Authentication) 사용자 인증 요청, 액세스 허용 메시지, 액세스 거부 메시지, 계정 요청 및 응답에 대 한 계정 및 정기적으로 수행을 구성할 수 있습니다. 상태 업데이트 합니다. 계정 데이터를 저장 하려는 로그 파일을 구성 하려면이 절차를 사용할 수 있습니다.

로그 파일을 해석 하는 방법에 대 한 자세한 내용은 참조 하세요. [NPS 데이터베이스 형식 로그 파일 해석](https://technet.microsoft.com/library/cc771748.aspx)합니다.

로그 파일을 하드 드라이브를 채우지 않으려면는 시스템 파티션과에서 별개의 파티션에 유지 하는 것이 좋습니다. 다음 NPS에 대 한 계정 구성에 대 한 자세한 정보를 제공 합니다.

- 다른 프로세스에 의해 컬렉션에 대 한 로그 파일 데이터를 보낼 명명된 된 파이프에 쓸 수는 NPS를 구성할 수 있습니다. 명명 된 파이프를 사용 하려면 로그 파일 폴더를 설정 합니다 \\. \pipe 또는 \\ComputerName\pipe 합니다. 명명 된 파이프 서버 프로그램 라는 명명된 된 파이프를 만들고 \\.\pipe\iaslog.log 데이터를 허용 하도록 합니다. 만들 새 로그 파일을 선택 하지 않습니다 (파일 크기 제한 없음된)에서 로컬 파일 속성 대화 상자에서 명명 된 파이프를 사용 하는 경우.

- % Systemdrive %, %systemroot% 및 %windir% 같은 사용자 변수) (대신 시스템 환경 변수를 사용 하 여 로그 파일 디렉터리를 만들 수 있습니다. 예를 들어, 환경 변수 %windir% 사용 하 여 다음 경로로 하위 \System32\Logs에서 시스템 디렉터리에서 로그 파일을 찾습니다 (즉, %windir%\System32\Logs\)합니다.

- 로그 파일 형식을 전환 하는 경우에 생성 될 새 로그를 발생 하지 않습니다. 로그 파일 형식을 변경한 경우 변경 시 활성 상태인 파일은 혼합 두 가지 형식 (레코드 로그의 시작 부분에 형식이 이전 및 기록 로그의 끝에 새 형식이 됩니다).

- RADIUS 계정 전체 하드 디스크 드라이브 또는 기타 원인으로 인해 실패 하면 NPS 처리를 중지 연결 요청을 사용자가 네트워크 리소스에 액세스 하지 못하도록 방지 합니다.

- NPS를 로컬 파일에 로깅 외에, 또는 instead of Microsoft® SQL Server™ 데이터베이스에 기록 하는 기능을 제공 합니다.

멤버 자격에는 **Domain Admins** 그룹은이 절차를 수행 하려면 최소한 합니다.


### <a name="to-configure-nps-log-file-properties"></a>NPS 로그 파일 속성을 구성 하려면

1. NPS 콘솔 또는 NPS Microsoft Management Console (MMC) 스냅인을 엽니다.
2. 콘솔 트리에서 **Accounting**합니다.
3. 세부 정보 창에서에서 **로그 파일 속성**, 클릭 **변경 로그 파일 속성**합니다. 합니다 **로그 파일 속성** 대화 상자가 열립니다.
4. **로그 파일 속성**의 합니다 **설정** 탭의 **다음 정보를 기록**, 회계 목표를 달성 하기 위해 충분 한 정보를 기록 하도록 선택 했는지 확인 합니다. 예를 들어 로그를 세션 상관 관계를 수행 해야 하는 경우 모든 확인란을 선택 합니다.
5. **실패 한 경우 동작 로깅**를 선택 **실패를 기록 하는 경우 연결 요청을 무시** 어떤 이유로 로그 파일은 전체 또는 사용할 수 없는 경우 액세스 요청 메시지를 처리를 중지 하려면 NPS를 하려는 경우. 계속 해 서 로깅이 실패할 경우 연결 요청을 처리 하는 NPS를 하려는 경우에이 확인란을 선택 하지 마십시오.
6. 에 **로그 파일 속성** 대화 상자에서 클릭 합니다 **로그 파일** 탭 합니다.
7. 에 **로그 파일** 탭의 **Directory**, NPS 로그 파일을 저장 하려는 위치를 입력 합니다. 기본 위치는 systemroot\System32\LogFiles 폴더입니다.<br>전체 경로 문을 제공 하지 않는 경우 **로그 파일 디렉터리**, 기본 경로 사용 합니다. 예를 들어 입력할 **NPSLogFile** 에 **로그 파일 디렉터리**, 파일은 %systemroot%\System32\NPSLogFile 합니다.
8. **형식**, 클릭 **DTS 규격**합니다. 원하는 경우와 같은 레거시 파일 형식으로를 대신 선택할 수 있습니다 **ODBC \(레거시\)**  하거나 **IAS \(레거시\)** 합니다.<br>**ODBC** 하 고 **IAS** NPS에서 SQL Server 데이터베이스에 보내는 정보의 하위 집합을 포함 하는 레거시 파일 형식입니다. 합니다 **DTS 규격** 파일 형식의 XML 형식으로 NPS를 사용 하 여 해당 SQL Server 데이터베이스로 데이터를 가져올 XML 형식으로 동일 합니다. 따라서 합니다 **DTS 규격** 파일 형식 NPS에 대 한 표준 SQL Server 데이터베이스로 데이터를 더 효율적이 고 전체 전송을 제공 합니다.
9. **새 로그 파일을 만들**, 사용 하려는 간격을 지정 된 간격으로 새 로그 파일을 시작 하는 NPS를 구성 하려면:
    - 많은 트랜잭션 볼륨 및 로깅 작업에 대 한 클릭 **일일**합니다.
    - 더 낮은 트랜잭션 볼륨 및 로깅 작업에 대 한 클릭 **주간** 또는 **월간**합니다.
    - 모든 트랜잭션 로그 파일에 저장 하려면 클릭 **Never \(파일 크기 제한 없음된\)** 합니다.
    - 각 로그 파일의 크기를 제한 하려면 클릭 **로그 파일에이 크기를 도달 하면**, 새 로그를 만든 후 파일 크기를 입력 합니다. 기본 크기는 10mb (MB)입니다.
10. 하드 디스크 용량에 근접 때 새 로그 파일에 대 한 디스크 공간을 만들려면 이전 로그 파일을 삭제 하는 NPS를 원한다 면 했는지 **디스크 경우 전체 삭제 오래 된 로그 파일** 을 선택 합니다. 하지만이 옵션이 제공 되지 않습니다, 경우 값 **새 로그 파일을 만듭니다** 됩니다 **Never \(파일 크기 제한 없음된\)** 합니다. 또한 가장 오래 된 로그 파일은 현재 로그 파일을이 삭제 되지 않습니다.

## <a name="configure-nps-sql-server-logging"></a>NPS SQL Server 로깅 구성

Microsoft SQL Server를 실행 하는 로컬 또는 원격 데이터베이스에 로그 RADIUS 계정 데이터에이 절차를 사용할 수 있습니다.

>[!NOTE]
>NPS 보내는 XML 문서로 회계 데이터의 형식을 지정 합니다 **report_event** NPS에서 지정 하는 SQL Server 데이터베이스에서 저장 프로시저입니다. SQL Server가 제대로 작동 하려면 로깅, 해야 라는 저장된 프로시저 **report_event** 수신 하 고 NPS에서 XML 문서를 구문 분석할 수 있는 SQL Server 데이터베이스에 있습니다.

Domain Admins 또는 이와 동등한 자격이는이 절차를 완료 하는 데 필요한 최소입니다.

### <a name="to-configure-sql-server-logging-in-nps"></a>NPS를 로그인 하는 SQL Server를 구성 하려면

1. NPS 콘솔 또는 NPS Microsoft Management Console (MMC) 스냅인을 엽니다.
2. 콘솔 트리에서 **Accounting**합니다.
3. 세부 정보 창에서에서 **SQL Server 로깅 속성**, 클릭 **SQL Server 로깅 속성 변경**합니다. 합니다 **SQL Server 로깅 속성** 대화 상자가 열립니다.
4. **다음 정보를 기록**, 정보를 기록 하려는 선택 합니다. 
    - 모든 계정 요청을 로그, 클릭 **계정 요청**합니다.
    - 인증 요청 로그, 클릭 **인증 요청**합니다.
    - 주기적 계정 상태를 기록 하려면 클릭 **주기적 계정 상태**합니다.
    - 중간 회계 요청과 같은 주기적인 상태를 기록 하려면 클릭 **정기 상태**합니다.
5. NPS 및 SQL Server를 실행 하는 서버 사이 허용 되는 동시 세션 수를 구성 하려면 숫자를 입력 **최대 동시 세션**합니다.
6. SQL Server 데이터 원본에서 구성 하려면 **SQL Server 로깅**, 클릭 **구성**합니다. 합니다 **데이터 연결 속성** 대화 상자가 열립니다. 에 **연결** 탭에서 다음을 지정 합니다. 
    - 데이터베이스 저장 되어 있는 서버의 이름을 지정 하려면 입력 하거나에서 이름을 선택 **서버 이름 선택 또는 입력**합니다.
    - 서버에 로그온 할 수 있는 인증 방법을 지정 하려면 클릭 **사용 하 여 Windows NT 통합 보안**합니다. 또는 클릭 **특정 사용자 이름 및 암호를 사용 하 여**에서 자격 증명을 입력 **사용자 이름** 하 고 **암호**.
    - 빈 암호를 허용 하려면 클릭 **암호가**합니다.
    - 암호를 저장 하려면 클릭 **암호 저장 허용**합니다.
    - SQL Server를 실행 하는 컴퓨터에서 연결할 데이터베이스를 지정 하려면 클릭 **서버에서 데이터베이스를 선택**, 목록에서 데이터베이스 이름을 선택 합니다.
7. NPS 및 SQL Server 간 연결을 테스트 하려면 클릭 **연결 테스트**합니다. 클릭 **확인** 닫으려면 **데이터 연결 속성**합니다.
8. **로깅 실패 동작**를 선택 **장애 조치에 대 한 텍스트 파일 로깅** NPS 텍스트 파일 로깅 SQL Server 로깅 실패 하는 경우 계속 하려면 사용 하려는 경우. 
9. **실패 한 경우 동작 로깅**를 선택 **실패를 기록 하는 경우 연결 요청을 무시** 어떤 이유로 로그 파일은 전체 또는 사용할 수 없는 경우 액세스 요청 메시지를 처리를 중지 하려면 NPS를 하려는 경우. 계속 해 서 로깅이 실패할 경우 연결 요청을 처리 하는 NPS를 하려는 경우에이 확인란을 선택 하지 마십시오.

## <a name="ping-user-name"></a>Ping 사용자 이름

일부 RADIUS 프록시 서버와 네트워크 액세스 서버 정기적으로 NPS는 네트워크에 있는지 확인 하려면 (ping 요청 라고도 함) 하는 인증 및 계정 요청을 보냅니다. 이러한 ping 요청에는 가상의 사용자 이름을 포함합니다. NPS는 이러한 요청을 처리할 때 액세스 거부 레코드, 올바른 레코드를 추적 하는 것이 어려울 이벤트 및 회계 로그 채워지지 않게 합니다.

에 대 한 레지스트리 항목을 구성 하는 경우 **사용자 이름을 ping**를 NPS에 다른 서버에서 ping 요청에 있는 사용자 이름 값에 대 한 레지스트리 항목 값과 일치 합니다. A **사용자 이름을 ping** 레지스트리 항목 RADIUS 프록시 서버와 네트워크 액세스 서버에서 전송 하는 가상의 사용자 이름 (또는 사용자 이름, 변수를 사용 하 여 일치 하는 패턴 가상의 사용자 이름)을 지정 합니다. NPS와 일치 하는 ping 요청을 수신 하는 경우는 **사용자 이름을 ping** 레지스트리 항목 값, NPS는 요청을 처리 하지 않고 인증 요청을 거부 합니다. NPS는 이벤트 로그를 더 쉽게 해석 하는 모든 로그 파일을 가상의 사용자 이름이 포함 된 트랜잭션을 기록 하지 않습니다.

**사용자 이름을 ping** 기본적으로 설치 되지 않습니다. 추가 해야 합니다 **사용자 이름을 ping** 레지스트리에 합니다. 레지스트리 편집기를 사용 하 여 레지스트리 항목을 추가할 수 있습니다.

>[!CAUTION]
>레지스트리를 잘못 편집하면 시스템에 심각한 손상을 줄 수 있으므로 따라서 레지스트리를 변경하기 전에 컴퓨터의 중요한 데이터를 백업해 두어야 합니다.

### <a name="to-add-ping-user-name-to-the-registry"></a>Ping 사용자 이름 레지스트리에 추가 하려면

Ping 사용자 이름 수에 추가한 다음 레지스트리 키를 문자열 값으로 로컬 Administrators 그룹의 구성원:

`HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IAS\Parameters`

- **이름**: `ping user-name`
- **형식**: `REG_SZ`
- **데이터**:  *사용자 이름*

>[!TIP]
>에 대 한 둘 이상의 사용자 이름을 나타내는 데는 **사용자 이름을 ping** 값, DNS 이름에 와일드 카드 문자를 포함 하 여 같은 이름 패턴을 입력 **데이터**입니다.
