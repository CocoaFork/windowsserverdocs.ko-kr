---
title: Hyper-v 저장소 I/O 성능
description: Hyper-v 성능 튜닝에 저장소 i/o 성능 고려 사항
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: Asmahi; SandySp; JoPoulso
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: fedc23083914bcf97a8cde12b78c0b174143de25
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59831314"
---
# <a name="hyper-v-storage-io-performance"></a>Hyper-v 저장소 I/O 성능

이 섹션에서는 다양 한 옵션 및 저장소 가상 머신의 I/O 성능 튜닝에 대 한 고려 사항에 설명 합니다. 호스트 저장소 스택의 이동한 다음 실제 디스크에 저장소 I/O 경로의 호스트 가상화 계층을 통해 게스트 저장소 스택에서 확장합니다. 다음 표에서 최적화 이러한 각 단계에서 가능한 정도 대 한 설명입니다.

## <a name="virtual-controllers"></a>가상 컨트롤러

Hyper-v는 세 가지 유형의 가상 컨트롤러를 제공합니다. IDE, SCSI, 및 가상 Hba (호스트 버스 어댑터).

## <a name="ide"></a>IDE

IDE 컨트롤러에는 IDE 디스크를 가상 머신에 노출합니다. IDE 컨트롤러에는 캐싱이 에뮬레이트됩니다, 이며 이전 버전의 가상 컴퓨터 통합 서비스 없이 Windows 실행 하는 게스트 Vm에 사용할 수 있는 유일한 컨트롤러입니다. 가상 컴퓨터 통합 서비스를 사용 하 여 제공 되는 IDE 필터 드라이버를 사용 하 여 수행 되는 I/O 디스크는 디스크 I/O 성능 에뮬레이트된 IDE 컨트롤러를 사용 하 여 제공 되는 경우 보다 훨씬 높습니다. 운영 체제 디스크에만 이러한 장치에 발급 될 수 있는 최대 I/O 크기로 인해 성능 제한이 있기 때문에 IDE 디스크를 사용 하는 것이 좋습니다.

## <a name="scsi-sas-controller"></a>SCSI (SAS 컨트롤러)

SCSI 컨트롤러 가상 머신에 SCSI 디스크를 노출 하 고 가상 SCSI 컨트롤러 마다 최대 64 개의 장치를 지원할 수 있습니다. 최적의 성능을 위해 단일 가상 SCSI 컨트롤러에 여러 디스크를 연결 하 고 가상 머신에 연결 된 디스크 수를 조정 하는 데 필요한 만큼만 추가 컨트롤러를 만들 것이 좋습니다. SCSI 경로 모든 디스크 외의 운영 체제 디스크에 대 한 기본 컨트롤러는 에뮬레이트되지 않습니다. 사실 2 세대 Vm을 사용 하 여 가능한 컨트롤러의 유일한 형식입니다. Windows Server 2012 R2에 도입 된,이 컨트롤러에 보고 됩니다 SAS와 공유 VHDX 지원.

## <a name="virtual-fibre-channel-hbas"></a>가상 파이버 채널 Hba

가상 파이버 채널 Hba 이더넷 (FCoE) Lun을 통해 파이버 채널 및 파이버 채널 가상 머신에 대 한 직접 액세스를 허용 하도록 구성할 수 있습니다. 가상 파이버 채널 디스크를 저장소 I/O의 CPU 사용량을 줄일 수는 루트 파티션에 NTFS 파일 시스템을 무시 합니다.

큰 데이터 드라이브 (게스트 클러스터링 시나리오)에 대 한 여러 가상 컴퓨터 간에 공유 되는 드라이브와 가상 파이버 채널 디스크에 대 한 주요 후보입니다.

가상 파이버 채널 디스크 하나 이상의 파이버 채널 호스트 버스 어댑터 (Hba) 호스트에 설치할 필요 합니다. 각 호스트 HBA는 Windows Server 2016 가상 파이버 채널/NPIV 기능을 지 원하는 HBA 드라이버를 사용 해야 합니다. SAN 패브릭을 NPIV를 지원 해야 하 고 가상 파이버 채널에 사용 되는 HBA 포트는 NPIV를 지 원하는 파이버 채널 토폴로지에 설정 되어야 합니다.

둘 이상의 HBA를 사용 하 여 설치 된 호스트에 대 한 처리량을 최대화 하려면 Hyper-v 가상 머신 내에서 여러 가상 Hba를 구성 하는 권장 (최대 4 개의 Hba 각 가상 머신에 대해 구성할 수 있음). Hyper-v에는 자동으로 동일한 가상 SAN에 액세스 하는 호스트 Hba에 가상 Hba 분산을 위해 최선을 다 해.

## <a name="virtual-disks"></a>가상 디스크

디스크는 가상 컨트롤러를 통해 virtual machines에 노출할 수 있습니다. 이러한 디스크는 디스크 또는 호스트의 통과 디스크의 파일 추상화는 가상 하드 디스크 일 수 있습니다.

## <a name="virtual-hard-disks"></a>가상 하드 디스크

두 개의 가상 하드 디스크 형식으로 VHD 및 VHDX 가지가 있습니다. 각 형식의 세 가지 유형의 가상 하드 디스크 파일을 지원합니다.

## <a name="vhd-format"></a>VHD 형식

VHD 형식의 경우 이전 릴리스에서 Hyper-v에서 지원 하 던 가상 하드 디스크 형식 Windows Server 2012에 도입 된, VHD 형식의 새로운 대규모 섹터 디스크에서 성능이 크게 향상 하는 보다 잘 조정할 수 있도록 수정 되었습니다.

Windows Server 2012 또는 최신 만들어지는 모든 새 VHD에 최적의 4KB 맞춤 정렬 된이 형식은 이전 Windows Server 운영 체제와 완전히 호환 됩니다. 그러나 맞춤 속성이 하지 4KB 맞춤 인식 (이전 버전의 Windows Server에서 VHD 파서) 또는 Microsoft 이외의 파서 같은 된 파서에서 새 할당을 위해 중단 됩니다.

이전 버전에서 이동 된 모든 VHD이 새로운 향상 된 VHD 형식으로 자동으로 변환 하지 않습니다.

새 VHD 형식으로 변환 하려면 다음 Windows PowerShell 명령을 실행 합니다.

``` syntax
Convert-VHD –Path E:\vms\testvhd\test.vhd –DestinationPath E:\vms\testvhd\test-converted.vhd
```

시스템에서 모든 Vhd에 대 한 맞춤 속성을 확인할 수 있습니다 하 고 최적의 4KB 맞춤으로 변환 해야 합니다. 사용 하 여 원래 VHD에서 데이터를 사용 하 여 새 VHD를 만들면 합니다 **소스에서 만들기** 옵션입니다.

를 확인 하려면 맞춤에 대 한 Windows Powershell을 사용 하 여 아래와 같이 맞춤 선을 검사 합니다.

``` syntax
Get-VHD –Path E:\vms\testvhd\test.vhd

Path                    : E:\vms\testvhd\test.vhd
VhdFormat               : VHD
VhdType                 : Dynamic
FileSize                : 69245440
Size                    : 10737418240
MinimumSize             : 10735321088
LogicalSectorSize       : 512
PhysicalSectorSize      : 512
BlockSize               : 2097152
ParentPath              :
FragmentationPercentage : 10
Alignment               : 0
Attached                : False
DiskNumber              :
IsDeleted               : False
Number                  :
```

맞춤을 Windows PowerShell을 사용 하 여 확인 하려면 아래와 같이 맞춤 선을 검사 합니다.

``` syntax
Get-VHD –Path E:\vms\testvhd\test-converted.vhd

Path                    : E:\vms\testvhd\test-converted.vhd
VhdFormat               : VHD
VhdType                 : Dynamic
FileSize                : 69369856
Size                    : 10737418240
MinimumSize             : 10735321088
LogicalSectorSize       : 512
PhysicalSectorSize      : 512
BlockSize               : 2097152
ParentPath              :
FragmentationPercentage : 0
Alignment               : 1
Attached                : False
DiskNumber              :
IsDeleted               : False
Number                  :
```

## <a name="vhdx-format"></a>VHDX 형식

VHDX는 최대 64tb) 복원 력 있는 고성능 가상 디스크를 만들 수 있는 Windows Server 2012에 도입 된 새 가상 하드 디스크 형식. 이 형식의 이점은 다음과 같습니다.

-   최대 64tb의 가상 하드 디스크 저장소 용량을 지원 합니다.

-   VHDX 메타데이터 구조에 업데이트를 기록하여 정전 시 데이터 손상으로부터 보호

-   사용자가 같은 운영 체제 버전이 나 패치 적용, 기록 하려는 파일에 대 한 사용자 지정 메타 데이터를 저장할 수 있습니다.

VHDX 형식에는 또한 다음과 같은 성능 이점을 제공합니다.

-   대규모 섹터 디스크에서 제대로 작동하도록 가상 하드 디스크 형식의 정렬 개선

-   워크 로드의 요구에 맞게 맞출 수 이러한 디스크를 허용 하는 동적이 고 차등 디스크에 대 한 더 큰 블록 크기입니다.

-   4KB 논리적 섹터 가상 디스크 4KB 섹터에 대 한 응용 프로그램을 설계 하는 워크 로드를 사용 하는 경우 성능 향상된을 위해 수 있도록 합니다.

-   작은 파일 크기가 사용 되지 않는 공간을 확보 하려면 기본 실제 저장소 장치를 수 있는 데이터 표현의 효율성입니다. (Trim 통과 또는 SCSI 디스크 및 트리밍 호환 하드웨어가 필요합니다.)

Windows Server 2016으로 업그레이드할 때 이러한 장점으로 인해 VHDX 형식으로 모든 VHD 파일을 변환 하는 것이 좋습니다. 가상 컴퓨터에 이전 릴리스의 VHDX 형식을 지원 하지 않는 Hyper-v로 이동할 때 여기서 하기가 VHD 형식으로 파일을 보관 하는 것이 유일한 시나리오는 표시 합니다.

## <a name="types-of-virtual-hard-disk-files"></a>가상 하드 디스크 파일의 형식

세 가지 유형의 VHD 파일이 있습니다. 다음 섹션에는 성능 특성 및 형식 간의 장단점은입니다.

다음 권장 사항은 관련 VHD 파일 형식을 선택 하 여 고려해 야 합니다.

-   VHD 형식을 사용 하는 경우에 더 나은 복원 력 및 성능 특성을 다른 VHD 파일 형식에 비해 있기 때문에 고정된 형식을 사용 하는 것이 좋습니다.

-   VHDX 형식을 사용 하는 경우에 연결 작업을 수행 해야 하는 경우에 공간을 할당 된 공간을 절약 하는 것 외에도 복원 력을 보장을 제공 하기 때문에 동적 형식을 사용 하는 것이 좋습니다.

-   고정 된 형식의 권장 된 형식에 관계 없이 호스팅 볼륨의 저장소 디스크 공간이 있는지 확인 VHD 파일이 런타임에 확장 하는 경우에 적극적으로 모니터링 하지 않는 경우.

-   가상 머신의 스냅숏 만들기는 차이점 보관용 VHD를 저장할 디스크에 씁니다. 있는 몇몇 스냅숏 수 있지만 저장소 I/o의 CPU 사용량을 하지 눈에 띄게 승격할 수 있습니다만 성능에에서 영향을 제외 하 고 O-많은 서버 워크 로드. 그러나, VHD에서 읽는 많은 차이점 보관용 Vhd에서 요청된 된 블록에 대 한 검사 해야 할 수 있으므로 스냅숏의 체인이 대규모로 성능이 저하 눈에 띄게 수 있습니다. 스냅숏 체인을 짧게 유지 하는 것이 좋은 디스크 I/O 성능을 유지 하는 것에 대 한 중요 합니다.

## <a name="fixed-virtual-hard-disk-type"></a>가상 하드 디스크 유형을 고정

VHD 파일을 만들 때에 먼저 VHD에 대 한 공간 할당 됩니다. 이 VHD 파일이 형식을 가능성이 적습니다 조각에 하나의 I/O로 여러 개의 입출력으로 분할 될 때 I/O 처리량을 줄입니다. 읽기 및 쓰기 않아도 블록의 매핑을 조회 하기 때문에 세 개의 VHD 파일 형식의 가장 낮은 CPU 오버 헤드가 있습니다.

## <a name="dynamic-virtual-hard-disk-type"></a>동적 가상 하드 디스크 형식

필요에 따라 VHD에 대 한 공간 할당 됩니다. 디스크에 블록 할당 되지 않은 블록으로 시작 하 고 파일의 실제 공간 백업 하지 않습니다. 블록 첫 번째 경우 기록 가상화 스택 블록에 대 한 VHD 파일 내에서 공간을 할당 하며 그런 다음 메타 데이터를 업데이트 합니다. 이 쓰기에 대 한 필요한 디스크 I/o의 수를 증가 시키고 CPU 사용량이 증가 합니다. 읽기 및 블록의 매핑 메타 데이터에서를 조회할 때 기존 블록 쓰기 디스크 액세스 및 CPU 오버 헤드가 발생 합니다.

## <a name="differencing-virtual-hard-disk-type"></a>차이점 보관용 가상 하드 디스크 형식

VHD 부모 VHD 파일을 가리킵니다. 동적 확장 VHD와 마찬가지로 발생 되는 VHD 파일에서 할당 된 공간에 기록 되지 않고 블록에 대 한 쓰기가 됩니다. 읽기는 블록에 기록 된 경우 VHD 파일에서 처리 됩니다. 그렇지 않은 경우 해당 부모 VHD 파일에서 처리 됩니다. 두 경우 모두에 블록의 매핑을 확인 하려면 메타 데이터를 읽습니다. 읽고이 VHD에 대 한 쓰기를 고정된 VHD 파일 보다 더 많은 I/o 발생 및 더 많은 CPU를 사용할 수 있습니다.

## <a name="block-size-considerations"></a>블록 크기 고려 사항

블록 크기에는 성능이 크게 영향을 수 있습니다. 디스크를 사용 하는 워크 로드의 할당 패턴에 블록 크기와 일치 하는 것이 적합 합니다. 예를 들어, 응용 프로그램 16MB의 청크에서를 할당 하는 경우 것이 16MB의 가상 하드 디스크 블록 크기는 데 가장 적합 합니다. 블록 크기를 &gt;2MB VHDX 형식의 가상 하드 디스크에만 가능 합니다. 임의의 I/O 워크 로드에 대 한 할당 패턴 보다 더 큰 블록 크기를 가진 호스트의 공간 사용량이 크게 늘어납니다.

## <a name="sector-size-implications"></a>섹터 크기가 영향

대부분의 소프트웨어 업계에 512 바이트의 디스크 섹터에 종속 되어 있지만 4KB 디스크 섹터에 표준으로 이동 합니다. 섹터 크기가 변경에서 발생할 수 있는 호환성 문제를 줄이기 위해 하드 드라이브 공급 업체는 512 에뮬레이션 드라이브 (512e) 라고 하는 전환 크기를 도입 되었습니다.

이러한 에뮬레이션 드라이브에서 4KB 디스크 섹터 기본 드라이브, 예: 형식 효율성 개선된 및 (ECC) 오류 수정 코드에 대 한 향상 된 체계를 제공 하는 경우 이점 중 일부를 제공 합니다. 이러한 디스크 인터페이스에서 4KB 섹터 크기를 노출 하 여 발생 하는 호환성 문제를 더 적은 함께 제공 됩니다.

## <a name="support-for-512e-disks"></a>512e 디스크에 대 한 지원

512e 디스크는 실제 섹터에 관해서만 쓰기를 수행할 수 있습니다-즉,에 대해 실행 되는 512 바이트 섹터를 직접 쓸 수 없습니다. 이러한 쓰기 가능 하 게 하는 디스크의 내부 프로세스는 이러한 단계를 따릅니다.

-   디스크 쓰기에서 참조 하는 512 바이트 논리 섹터를 포함 하는 내부 캐시에 4KB 물리적 섹터를 읽습니다.

-   4KB 버퍼에 있는 데이터는 업데이트된 512바이트 섹터를 포함하도록 수정됩니다.

-   디스크는 디스크에 다시 해당 물리적 섹터에 업데이트 된 4KB 버퍼 쓰기를 수행합니다.

이 프로세스에는 읽기-수정-쓰기 (RMW) 라고 합니다. RMW 프로세스의 전반적인 성능 영향은 워크 로드에 따라 달라 집니다. 다음과 같은 이유로 하면 성능이 저하 될 가상 하드 디스크의 RMW 프로세스:

-   동적 및 차이점 보관용 가상 하드 디스크는 데이터 페이로드 앞에 512 바이트 섹터 비트맵이 경우 또한 바닥글, 머리글 및 부모 로케이터는 512 바이트 섹터에 맞춥니다. 앞에서 설명한 RMW 프로세스에서 발생 하는이 구조를 업데이트 하려면 512 바이트 쓰기 명령 실행 하는 가상 하드 디스크 드라이버에 대 한 일반적인 것입니다.

-   응용 프로그램 일반적으로 문제 읽기 및 쓰기 4KB 크기 (NTFS의 기본 클러스터 크기)의 배수로 청구 됩니다. 동적 데이터 페이로드 블록 앞에 512 바이트 섹터 비트맵이 고 차이점 보관용 가상 하드 디스크를 4KB 블록은 정렬 되지 물리적 4KB 경계에 때문에. 다음 그림에는 VHD 4 KB 블록을 (강조 표시) 된 물리적 4KB 경계에 정렬 되지 보여 줍니다.

![vhd 4kb 블록](../../media/perftune-guide-vhd-4kb-block.png)

페이로드 데이터를 업데이트 하려면 현재 파서에서 발급 한 각 4KB 쓰기 명령이 업데이트 되 고 두 디스크 블록에 다시 쓸 이후에 디스크에서 두 블록에 대 한 두 개의 읽기에서 발생 합니다. Windows Server 2016의 Hyper-v는 VHD 형식으로 4KB 경계에 대 한 맞춤에 대 한 앞에서 언급 한 구조를 준비 하 여 VHD 스택에 512e 디스크에서 성능 효과 중 일부를 완화 합니다. 이 가상 하드 디스크 파일 내에서 데이터에 액세스할 때 및 가상 하드 디스크 메타 데이터 구조를 업데이트할 때 RMW 영향을 피할 수 있습니다.

앞에서 설명한 대로 이전 버전의 Windows Server에서 복사 된 Vhd는 자동으로 맞춰지지 4kb입니다. 사용 하 여 최적으로 맞게으로 수동으로 변환할 수 있습니다 합니다 **원본의 복사본** 디스크 VHD 인터페이스에서 사용할 수 있는 옵션입니다.

기본적으로 Vhd는 512 바이트 물리적 섹터 크기를 사용 하 여 노출 됩니다. 이전 버전의 Windows Server에서 응용 프로그램 및 Vhd를 이동할 때 물리적 섹터 크기 종속 된 응용 프로그램이 영향을 받지는 되도록 수행 됩니다.

기본적으로 해당 성능 프로필에 대 한 일반 디스크 및 대규모 섹터 디스크를 최적화 하기 위해 4KB 물리적 섹터 크기 포함 디스크를 VHDX 형식으로 만들어집니다. 4KB 섹터를 최대한 활용 하는 것이 좋습니다 VHDX 형식을 사용 합니다.

## <a name="support-for-native-4kb-disks"></a>기본 4KB 디스크에 대 한 지원

Windows Server 2012 R2 이상에서는 4KB 기본 디스크 하이퍼-V. 이지만 기본 4KB 디스크에 VHD 디스크를 저장할 수 있습니다. 소프트웨어 RMW를 구현 하 여 이렇게 가상 저장소 스택의 계층을 해당 4KB 512 바이트 액세스 및 업데이트 요청을 변환 하는 알고리즘에 액세스 하 고 업데이트 합니다.

VHD 파일 512 바이트 논리 섹터 크기 디스크와 자체을 노출할만 수, 있으므로는 512 바이트 I/O 요청을 발급 하는 응용 프로그램 되도록 가능성이 높습니다. 이러한 경우에 RMW 계층은 이러한 요청을 충족 되며 성능 저하. 512 바이트 논리 섹터 크기가 VHDX로 포맷 된 디스크는이 마찬가지입니다.

4KB 논리 섹터 크기 디스크를으로 표시 되기 위해 VHDX 파일을 구성할 수 있으며 성능에 대 한 최적의 구성을 디스크 4KB 기본 물리적 장치에서 호스팅되는 경우. 게스트와 가상 디스크를 사용 하는 응용 프로그램은 4KB 논리 섹터 크기에 따라 백업 되도록 주의 해야 합니다. 서식 지정 VHDX 4KB 논리 섹터 크기가 장치에서 제대로 작동 합니다.

## <a name="pass-through-disks"></a>통과 디스크

가상 컴퓨터에서 VHD에 매핑될 수 물리적 디스크 또는 논리 단위 번호 (LUN)에 직접 대신 VHD 파일입니다. 장점은이 구성은 무시 NTFS 파일 시스템 저장소 I/O의 CPU 사용량을 줄일 수 있는 루트 파티션에 점입니다. 위험은 실제 디스크 또는 Lun에서 VHD 파일 보다는 컴퓨터 간에 이동할 어려울을 수 있습니다.

통과 디스크는 가상 머신 마이그레이션 시나리오를 사용 하 여 도입 된 제한으로 인해 피해 야 합니다.

## <a name="advanced-storage-features"></a>고급 저장소 기능

### <a name="storage-quality-of-service-qos"></a>저장소 서비스 품질(QoS)

Windows Server 2012 R2부터 Hyper-v 가상 머신에서 저장소에 대 한 특정 서비스 품질 (QoS) 매개 변수를 설정 하는 기능이 포함 되어 있습니다. 저장소 QoS는 저장소 I/O 성능이 Virtual Machine 워크로드를 효율적으로 실행하도록 정의된 임계값을 충족하지 않는 경우 이를 알리는 메커니즘과 다중 테넌트 환경에서 저장소 성능을 격리하는 기능을 제공합니다.

저장소 QoS는 가상 하드 디스크에 대한 최대 IOPS(초당 입/출력 작업 수) 값을 지정할 수 있는 기능을 제공합니다. 관리자는 저장소 I/O를 조절하여 테넌트가 다른 테넌트에 영향을 줄 수 있을 정도로 과도한 저장소 리소스를 사용하는 것을 중지할 수 있습니다.

또한 최소 IOPS 값을 설정할 수 있습니다. 이 값은 지정된 가상 하드 디스크의 IOPS가 최적 성능에 필요한 임계값에 미달하는 경우 이를 알립니다.

관리자가 성능 및 차지백 관련 매개 변수를 모니터링할 수 있는 저장소 관련 매개 변수를 통해 가상 컴퓨터 메트릭 인프라도 업데이트됩니다.

최대값 및 최소값은 데이터의 모든 8KB는 I/O로 계산 되는 위치는 정규화 된 IOPS를 기준으로 지정 됩니다.

제한 사항 중 일부는 다음과 같습니다.

-   가상 디스크에 대해서만

-   차이점 보관용 디스크를 다른 볼륨에 부모 가상 디스크를 사용할 수 없습니다.

-   복제본-기본 사이트에서 별도로 구성 된 복제본 사이트에 대 한 QoS

-   공유 VHDX 지원 되지 않습니다.

저장소 서비스 품질에 대 한 자세한 내용은 참조 하세요. [저장소 서비스 품질 hyper-v](https://technet.microsoft.com/library/dn282281.aspx)합니다.

### <a name="numa-io"></a>NUMA I/O

Windows Server 2012 이상 큰 가상 머신을 지원 하 고 (예: 64 개의 가상 프로세서를 사용 하 여 실행 중인 Microsoft SQL Server를 사용 하 여 구성)는 대규모 가상 머신 구성에는 I/O 처리량 측면에서 확장성도 필요 합니다.

다음과 같은 주요 향상 기능을 Windows Server 2012 저장소 스택 및 Hyper-v에서 처음 도입 된 큰 가상 머신의 I/O 확장성 요구를 제공 합니다.

-   게스트 장치와 호스트 저장소 스택을 생성 하는 통신 채널 수가 증가 합니다.

-   비용이 많이 드는 interprocessor 중단을 방지 하려면 가상 프로세서를 인터럽트 분포와 관련 된 보다 효율적인 I/O 완료 메커니즘입니다.

Windows Server 2012에 도입 된, 항목이 몇 가지 레지스트리, HKLM 위치한\\시스템\\CurrentControlSet\\Enum\\VMBUS\\{장치 id}\\{instance-id}\\StorChannel 조정 해야 하는 채널 수 있도록 합니다. 또한 응용 프로그램 I/O 프로세서 수에 할당 된 가상 Cpu에 I/O 완료를 처리 하는 가상 프로세서를 정렬 합니다. 레지스트리 설정은 장치의 하드웨어 키 어댑터별 기준에서 구성 됩니다.

-   **ChannelCount (DWORD)** 최대 16 개를 사용 하는 채널의 총 수입니다. 가상 프로세서/16의 수는 ceiling 기본값으로 사용 됩니다.

-   **ChannelMask (QWORD)** 채널에 대 한 프로세서 선호도입니다. 이 설정 되지 않았거나 0으로 설정 됩니다, 경우 일반 저장소 또는 네트워킹 채널을 사용 하는 기존 채널 배포 알고리즘 기본값이 됩니다. 이렇게 하면 저장소 채널 네트워크 채널을 사용 하 여 충돌 하지 않는지 합니다.

### <a name="offloaded-data-transfer-integration"></a>오프 로드 된 데이터 전송 통합

병합 등 Vhd에 대 한 중요 한 유지 관리 작업 압축 이동, 복사 많은 양의 데이터에 따라 달라 집니다. 현재의 데이터 복사 방법에서는 데이터를 읽고 다른 위치에 써야 하며 이러한 작업은 시간이 많이 소요될 수 있습니다. 또한 서비스 가상 컴퓨터에 사용 되었을 수 있는 호스트에서 CPU 및 메모리 리소스를 사용 합니다.

SAN(저장 영역 네트워크) 공급업체는 대량의 데이터를 거의 즉시 복사하는 기능을 제공하기 위해 최선을 다하고 있습니다. 이 저장소는 이동 하는 다른 곳에서 특정 데이터 집합을 지정 하는 디스크 위에 있는 시스템이 수 있도록 설계 되었습니다. 이 하드웨어 기능을 오프 로드 된 데이터 전송 이라고 합니다.

Windows Server 2012 이상 Hyper-v 호스트 하드웨어에 이러한 작업을 게스트 운영 체제에서 전달 될 수 있도록 오프 로드 데이터 전송 (ODX) 작업을 지원 합니다. 그러면 가상화 되지 않은 환경에서 실행 된 경우 처럼 워크 로드를가 ODX 지원 저장소를 사용할 수 있습니다. 또한 디스크 병합 및 저장소 마이그레이션 메타-작업과 대량의 데이터를 이동 하는 위치와 같은 Hyper-v 저장소 스택에서 Vhd에 대 한 유지 관리 작업 중이 ODX 작업을 실행 합니다.

### <a name="unmap-integration"></a>통합 매핑 해제

가상 하드 디스크 파일이 저장소 볼륨에서 파일 및 기타 파일을 사용 하 여 사용 가능한 공간을 공유할 합니다. 이러한 파일의 크기가 큰 편입니다, 때문에 사용 하는 공간을 신속 하 게 증가할 수 있습니다. 실제 저장소에 대 한 요구 IT 하드웨어 예산을 영향을 줍니다. 가능한 한 물리적 저장소의 사용을 최적화 하는 것이 반드시 합니다.

Windows Server 2012 이전 응용 프로그램 콘텐츠 저장소 공간을 효율적으로 중단 하는 가상 하드 디스크를 내에서 콘텐츠를 삭제 하는 경우 게스트 운영 체제 및 Hyper-v 호스트에서 Windows 저장소 스택 제한 사항을이 방지 하는 가상 하드 디스크 및 실제 저장소 장치에 전달 되는 정보입니다. 이 인해 Hyper-v 저장소 스택에서를에서 VHD 기반 가상 디스크 파일에서 공간 사용량을 최적화 하지 못했습니다. 또한 기본 저장소 장치를를 이전에 삭제 된 데이터에 의해 점유 했던 공간을 회수 하지 못했습니다.

Windows Server 2012에서부터 Hyper-v 지원 매핑을 VHDX 파일에 해당 데이터를 나타내는 더 효율적일 수 있는 알림을 해제. 이 인해 더 작은 파일 크기를 하 고 사용 하지 않는 공간을 확보 하려면 기본 실제 저장소 장치 수 있습니다.

만 하이퍼-V-특정 SCSI, IDE 및 가상 파이버 채널 컨트롤러에 연결할 게스트에서 unmap 명령을 허용 지원 호스트 가상 저장소 스택은 합니다. 가상 하드 디스크에서 가상 디스크만 지 원하는 VHDX로 포맷의 게스트에서 명령을 매핑을 해제 합니다.

이러한 이유로, 가상 파이버 채널 디스크를 사용 하지 않는 경우 SCSI 컨트롤러에 연결 하는 VHDX 파일을 사용 하는 것이 좋습니다.

## <a name="see-also"></a>참조

-   [Hyper-v 용어](terminology.md)

-   [Hyper-v 아키텍처](architecture.md)

-   [Hyper-v 서버-구성](configuration.md)

-   [Hyper-v 프로세서 성능](processor-performance.md)

-   [Hyper-v 메모리 성능](memory-performance.md)

-   [Hyper-v 네트워크 I/O 성능](network-io-performance.md)

-   [가상화 된 환경에서 병목 상태를 검색합니다.](detecting-virtualized-environment-bottlenecks.md)

-   [Linux Virtual Machines](linux-virtual-machine-considerations.md)
