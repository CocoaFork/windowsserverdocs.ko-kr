---
title: 추가 성능 튜닝에 사이트 정 및 도메인 컨트롤러 배치
description: 사이트 정 및 도메인 컨트롤러 배치 고려 사항에서 Active Directory 성능 튜닝 합니다.
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: TimWi; ChrisRob; HerbertM; KenBrumf;  MLeary; ShawnRab
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: 0e5c5f8b7cf5c028fbfa5d72c4bc1218565d4087
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59814024"
---
# <a name="proper-placement-of-domain-controllers-and-site-considerations"></a>적절 한 배치의 도메인 컨트롤러와 사이트 고려 사항

적절 한 사이트 정의 하는 것이 성능에 중요 합니다. 사이트를 벗어난 클라이언트 인증 및 쿼리 성능 저하를 발생할 수 있습니다. 또한 클라이언트에서 IPv6의 도입으로 IPv4 요청에서 가져올 수 있습니다 또는 IPv6 주소 및 Active Directory 사이트 IPv6에 대해 제대로 정의 해야 합니다. 운영 체제 모두 구성 되어 있는 경우 IPv4를 IPv6를 선호 합니다.

Windows Server 2008부터 클라이언트는 사이트를 확인 하기 위해 역방향 조회를 수행 하려면 이름 확인을 사용 하도록 도메인 컨트롤러 시도에 있어야 합니다. 이 ATQ 스레드 풀의 소모를 발생 하 고 도메인 컨트롤러가 응답 하지 않을 수 있습니다. 적절 한 확인이 제대로 IPv6에 대 한 사이트 토폴로지를 정의 하는 것입니다. 해결 방법으로 도메인 컨트롤러가 요청에 신속히 대응 하는 이름 확인 인프라를 최적화할 수 있습니다 하나. 자세한 내용은 참조 하세요. [Windows Server 2008 또는 Windows Server 2008 R2 도메인 컨트롤러에 LDAP 또는 Kerberos 요청에 응답 지연](https://support.microsoft.com/kb/2668820)합니다.

추가 영역을 고려해 야는 Rodc 사용에서 되는 시나리오에 대 한 읽기/쓰기 Dc를 찾는 중입니다.  특정 작업 쓰기 가능한 도메인 컨트롤러에 액세스 해야 하거나 읽기 전용 도메인 컨트롤러 충분할 때 쓰기 가능한 도메인 컨트롤러를 대상으로 합니다.  이러한 시나리오 최적화 걸리는 두 개의 경로:
-   읽기 전용 도메인 컨트롤러를 적절 하 게 하는 경우 쓰기 가능한 도메인 컨트롤러에 연결 합니다.  이렇게 하려면 응용 프로그램 코드를 변경 합니다.
-   여기서는 쓰기 가능한 도메인 컨트롤러는 할 수 있습니다.  대기 시간을 최소화 하려면 읽기 / 쓰기 도메인 컨트롤러 중앙 위치에서 발생 합니다.

자세한 내용은 참조:
-   [Rodc 사용 하 여 응용 프로그램 호환성](https://technet.microsoft.com/library/cc772597.aspx)
-   [서비스 인터페이스 ADSI (active Directory) 및 읽기만 도메인 컨트롤러 (RODC) – 성능 문제를 방지 합니다.](https://blogs.technet.microsoft.com/fieldcoding/2012/06/24/active-directory-service-interface-adsi-and-the-read-only-domain-controller-rodc-avoiding-performance-issues/)

## <a name="optimize-for-referrals"></a>조회에 대 한 최적화

조회는 도메인 컨트롤러는 파티션의 쿼리 복사를 호스팅하지 않는 경우 LDAP 쿼리는 리디렉션되어야 하는 방법입니다. 조회를 반환 되 면 파티션의 고유 이름, DNS 이름 및 포트 번호를 포함 합니다. 클라이언트가이 정보를 사용 하 여 파티션을 호스팅하는 서버에서 쿼리를 계속 합니다. 이것이 DCLocator 시나리오 및 권장 구성의 모든 사이트 정의 및 도메인 컨트롤러 배치는 유지 되지만 조회에 종속 된 응용 프로그램은 종종 간과 됩니다. 사이트 정의 포함 하는 AD 토폴로지를 확인 하는 것이 좋습니다. 및 클라이언트의 요구를 제대로 반영 하는 도메인 컨트롤러 배치 합니다. 또한 DNS 설정을 조정 하거나 응용 프로그램의 사이트를 재배치 한 사이트 내에서 여러 도메인에서 도메인 컨트롤러를 보유이 포함 될 수 있습니다.

## <a name="optimization-considerations-for-trusts"></a>트러스트에 대 한 최적화 고려 사항

포리스트 내 시나리오에서 트러스트는 다음 도메인 계층 구조에 따라 처리 됩니다. 그랜드 자식 도메인&gt; 자식 도메인&gt; 포리스트 루트 도메인-&gt; 자식 도메인-&gt; 그랜드 하위 도메인입니다. 이 즉, 포리스트 루트 및 각 상위 채널을 보호 하는 신뢰 계층 구조에서 Dc를 전송 하는 인증 요청의 집계로 인해 오버 로드할 수 있습니다. 인증 또한 위의 흐름에 영향을 매우 길지만 링크를 전송 해야 하는 경우 지연 큰 지리적 경향의 현재 디렉터리에도 발생할 수 있습니다. 오버 로드는 포리스트 간 및 하위 수준 신뢰 시나리오에서 발생할 수 있습니다. 다음 권장 사항은 모든 시나리오에 적용 됩니다.

-   보안 채널을 통해 부하를 지원할 MaxConcurrentAPI 제대로 조정 합니다. 자세한 내용은 참조 하세요. [MaxConcurrentApi 설정을 사용 하 여 NTLM 인증에 대 한 성능 튜닝을 수행 하는 방법을](https://support.microsoft.com/kb/2688798/EN-US)합니다.

-   부하에 따라 적절 하 게 바로 가기 트러스트를 만듭니다.

-   도메인의 모든 도메인 컨트롤러 이름 확인을 수행 하 고 신뢰할 수 있는 도메인의 도메인 컨트롤러와 통신할 수 있는지 확인 합니다.

-   위치 고려 사항 고려할 트러스트를 확인 합니다.

-   가능한 경우 Kerberos를 사용 하도록 설정 하 고 MaxConcurrentAPI 병목 상태를 실행 하는 위험을 줄이기 위해 보안 채널의 사용을 최소화 합니다.

도메인 간 트러스트 시나리오는 많은 고객을 고민 일관 된 하는 영역입니다. 이름 확인 및 연결 문제를 방화벽으로 인해 종종 트러스팅 도메인 컨트롤러에서 리소스 소모가 발생 하 고 모든 클라이언트에 영향을 줄. 또한 시나리오를 흔히 간과 되 신뢰할 수 있는 도메인 컨트롤러에 대 한 액세스를 최적화 됩니다. 이 제대로 작동 하는지 확인 하려면 주요 영역은 다음과 같습니다.

-   트러스팅 도메인 컨트롤러를 사용 하는 DNS 및 WINS 이름 확인에 신뢰할 수 있는 도메인의 도메인 컨트롤러의 정확한 목록을 확인할 수 있는지 확인 합니다.

    -   정적으로 추가 된 레코드 들이 유효 하지 않게 하 고 시간이 지남에 따라 연결 문제를 않기로 결정 했습니다. DNS 전달, 동적 DNS 및 병합 WINS/DNS 인프라는 장기 실행 유지 관리가 더 쉬워집니다.

    -   전달자, 조건부 전달 및 클라이언트에 액세스 할 수 있는 환경에서 모든 리소스에 대 한 정방향 및 역방향 조회 영역 모두에 대 한 보조 복사본의 구성이 적절 한지를 확인 합니다. 다시이 수동 유지 관리가 필요한 있고 유효 하지 않게 하는 경향이 있습니다. 인프라의 통합이 적합 합니다.

-   트러스팅 도메인의 도메인 컨트롤러는 먼저 동일한 사이트에 있는 신뢰할 수 있는 도메인을 변경한 다음 제네릭 로케이터에 대 한 장애 복구에 도메인 컨트롤러를 찾으려고 시도 합니다.

    -   DCLocator 작동 하는 방법에 대 한 자세한 내용은 참조 하세요. [가장 가까운 사이트에서 도메인 컨트롤러를 찾는](https://technet.microsoft.com/library/cc978016.aspx)합니다.

    -   동일한 위치에 도메인 컨트롤러를 반영 하기 위해 신뢰할 수 있고 트러스팅 도메인 간에 사이트 이름을 수렴 됩니다. 매핑 두 포리스트 내의 사이트에 제대로 연결 된 서브넷 및 IP 주소를 확인 합니다. 자세한 내용은 참조 하세요. [도메인 로케이터 간에 포리스트 트러스트](http://blogs.technet.com/b/askds/archive/2008/09/24/domain-locator-across-a-forest-trust.aspx)합니다.

    -   도메인 컨트롤러 위치에 대 한 DCLocator 필요에 따라 포트가 열려를 확인 합니다. 방화벽의 도메인 간에 존재 하는 경우 모든 트러스트에 대 한 방화벽 제대로 구성 되어 있는지 확인 합니다. 방화벽이 열려 있지 않은 경우에 트러스팅 도메인 컨트롤러를 신뢰할 수 있는 도메인에 액세스할 계속 하려고 합니다. 어떤 이유로 든 실패 하면 통신 트러스팅 도메인 컨트롤러에 결국 신뢰할 수 있는 도메인 컨트롤러에 요청 제한 시간이 됩니다. 그러나 이러한 시간 제한 요청에 따라 몇 초 정도 걸릴 수 있으며 들어오는 요청의 양이 많으면 트러스팅 도메인 컨트롤러에서 네트워크 포트 소모 될 수 있습니다. 클라이언트 (응용 프로그램이 포그라운드 스레드에서 요청 실행) 하는 경우 응답이 없는 응용 프로그램을 공유할 수는 응답이 없는 스레드로 도메인 컨트롤러에서 제한 시간을 대기 발생할 수 있습니다. 자세한 내용은 참조 하세요. [도메인 및 트러스트를 위한 방화벽을 구성 하는 방법](https://support.microsoft.com/kb/179442)합니다.

    -   DnsAvoidRegisterRecords를 사용 하 여 같은 제네릭 로케이터 광고에서 위성 사이트에 제대로 수행 되지 않았거나 대기 시간이 긴 도메인 컨트롤러를 제거 합니다. 자세한 내용은 참조 하세요. [클라이언트의 사이트 외부에 있는 글로벌 카탈로그 또는 도메인 컨트롤러의 위치를 최적화 하는 방법을](https://support.microsoft.com/kb/306602)합니다.

        **참고**    클라이언트가 사용할 수 있는 도메인 컨트롤러의 수를 50에 대 한 실용적인 제한 됩니다. 사이트를 최적의 등급과 가장 높은 용량 가장 해야 이러한 도메인 컨트롤러입니다.

         

    -   동일한 실제 위치에 신뢰할 수 있고 트러스팅 도메인의 도메인 컨트롤러를 배치 하는 것이 좋습니다.

모든 신뢰 시나리오에 대 한 자격 증명 인증 요청에 지정 된 도메인에 따라 라우팅됩니다. 에 마찬가지 쿼리에 대 한 LookupAccountName 및 LsaLookupNames (다른 뿐만 아니라 가장 일반적인 옵션 사용) Api입니다. 이러한 Api에 대 한 도메인 매개 변수를 NULL 값을 전달 하는 경우 도메인 컨트롤러를 사용할 수 있는 신뢰할 수 있는 모든 도메인에 지정 된 계정 이름을 찾으려면 하려고 합니다.

-   NULL 도메인을 지정 하는 경우 사용 가능한 모든 트러스트를 확인 하는 사용 하지 않도록 설정 합니다. [LsaLookupRestrictIsolatedNameLevel 레지스트리 항목을 사용 하 여 외부 트러스트 된 도메인에 isolated 이름 조회를 제한 하는 방법](https://support.microsoft.com/kb/818024)

-   사용 하지 않도록 모든 사용 가능한 트러스트에 걸쳐 지정 된 NULL 도메인을 사용 하 여 인증 요청을 전달 합니다. [많은 외부 트러스트는 Active Directory 도메인 컨트롤러에 있는 경우 응답 Lsass.exe 프로세스 중지](https://support.microsoft.com/kb/923241/EN-US)

## <a name="see-also"></a>참조
- [Active Directory 서버를 튜닝 하는 성능](index.md)
- [하드웨어 고려 사항](hardware-considerations.md)
- [LDAP 고려 사항](ldap-considerations.md)
- [추가 성능 문제 해결](troubleshoot.md) 
- [Active Directory Domain Services를 위한 용량 계획](https://go.microsoft.com/fwlink/?LinkId=324566)