---
title: 원격 데스크톱 세션 호스트 조정 성능
description: 성능 조정 지침에 대 한 원격 데스크톱 세션 호스트
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: HammadBu; VladmiS
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: e45d1abb545ad46e654c811a0347c589bd12adf0
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59863244"
---
# <a name="performance-tuning-remote-desktop-session-hosts"></a>원격 데스크톱 세션 호스트 조정 성능


이 항목에서는 원격 데스크톱 세션 호스트 (RD 세션 호스트) 하드웨어를 선택 하 고, 호스트 조정, 응용 프로그램을 튜닝 하는 방법을 설명 합니다.

**항목 내용**

-   [성능에 대 한 적절 한 하드웨어 선택](#hw)

-   [원격 데스크톱 세션 호스트에 대 한 응용 프로그램 튜닝](#apps)

-   [매개 변수를 튜닝 하는 원격 데스크톱 세션 호스트](#host)

## <a href="" id="hw"></a>성능에 대 한 적절 한 하드웨어 선택


RD 세션 호스트 서버 배포의 경우 하드웨어 선택은 사용자가 사용 하는 방법 및 응용 프로그램 집합으로 제어 됩니다. 사용자와 경험의 수에 영향을 주는 주요 요소는 CPU, 메모리, 디스크 및 그래픽 됩니다. 이 섹션에서는 RD 세션 호스트 서버에 관련 된 추가적인 지침을 제공 하 고 RD 세션 호스트 서버를 다중 사용자 환경에 주로 관련이 있습니다.

### <a name="cpu-configuration"></a>CPU 구성

CPU 구성 개념적으로 시스템을 지원 하기 위해 임시 스파이크를 처리 하는 버퍼 영역을 유지 관리 하는 동안 예상 되는 세션 수로 세션을 지 원하는 데 필요한 CPU를 곱하여 결정 됩니다. 여러 개의 논리적 프로세서는 일반적으로 비슷한 논리 프로세서 수가 포함 된 몇 가지 혼잡 스레드에서 발생 하는 비정상적인 CPU 정체 상황을 줄일 수 있습니다.

따라서 시스템에서 더 많은 논리 프로세서 낮을수록 쿠션 여백입니다. CPU 당 활성 부하의 더 큰 비율에는 CPU 사용량 예측 하 빌드해야 합니다. 하나의 중요 한 요소는 두 배로 Cpu 수를 기억해 야 배가 되지는 않는데 CPU 용량을 수행 합니다.

### <a name="memory-configuration"></a>메모리 구성

메모리 구성; 사용자를 사용 하는 응용 프로그램에 따라 다릅니다. 그러나 다음 수식을 사용 하 여 필요한 메모리 양을 예상할 수 있습니다. TotalMem = OSMem + SessionMem \* NS

OSMem는 얼마나 많은 운영 체제 SessionMem (예: 시스템 이진 이미지 데이터 구조 및 등) 실행 하는 데 필요한 메모리가 한 세션에서 실행 되는 메모리 내 프로세스 요구 하는 정도 및 NS 활성 세션의 대상입니다. 세션에 필요한 메모리 양이 응용 프로그램 및 세션 내에서 실행 되는 시스템 프로세스에 대 한 설정 전용 메모리 참조에 의해 주로 결정 됩니다. 공유 코드 또는 데이터 페이지는 시스템의 복사본을 하나만 있으므로 거의 영향을 미치지 합니다.

(페이지 파일을 백업 하는 디스크 시스템 변경 하지 않는 것으로 가정) 흥미로운 관찰 내용 하나는 많은 수의 동시 활성 세션 시스템 계획을 지원 하기 위해 클수록 세션별 메모리를 할당 해야 합니다. 세션당 할당 되는 메모리 양을 증가 하지는 경우 페이지 폴트 수 해당 활성 세션 생성 세션 수가 증가 합니다. 이러한 오류는 결국 I/O 하위 시스템 과부하. 페이지 폴트 발생 가능성이 감소 하면 세션당 할당 되는 메모리 양을 늘려 페이지 폴트의 전반적인 속도 줄일 수 있습니다.

### <a name="disk-configuration"></a>디스크 구성

RD 세션 호스트 서버를 구성 하 고 필드에 배포 되는 시스템에서 가장 일반적인 제한 수 저장소는 간과 측면 중 하나입니다.

일반적인 RD 세션 호스트 서버에서 생성 되는 디스크 작업의 다음 영역을 영향을 줍니다.

-   시스템 파일 및 응용 프로그램 이진 파일

-   페이지 파일

-   사용자 프로필 및 사용자 데이터

이상적으로 고유한 저장소 장치에서 다양 한이 분야를 백업 해야 합니다. 스트라이프 RAID 구성 또는 다른 유형의 추가 고성능 저장소를 사용 하 여 성능을 향상 시킵니다. 배터리 지원 쓰기 캐싱을 사용 하 여 저장소 어댑터를 사용 하는 것이 좋습니다. 디스크 쓰기 캐싱을 사용 하 여 컨트롤러에는 동기 쓰기 작업에 대 한 향상 된 지원을 제공합니다. 모든 사용자가 별도 hive 때문에 동기 쓰기 작업은 RD 세션 호스트 서버에서 훨씬 더 일반적입니다. 레지스트리 하이브는 주기적으로 저장 된 동기 쓰기 작업을 사용 하 여 디스크에 있습니다. 디스크 관리 콘솔에서 이러한 최적화를 사용 하도록 설정 하려면 엽니다는 **속성** 대상 디스크에 대 한 고 대화 상자를 **정책을** 탭을 선택는 **쓰기 캐싱을 사용 디스크** 하 고 **Windows 쓰기 캐시 버퍼 플러시 해제** 장치 확인란에 있습니다.

### <a name="network-configuration"></a>네트워크 구성

두 가지 주요 범주로 포함 하는 RD 세션 호스트 서버에 대 한 네트워크 사용:

-   RD 세션 호스트 연결 트래픽 사용량 발생 하는 세션 및 장치 리디렉션된 I/O 트래픽을 내에서 실행 되는 응용 프로그램에서 그리기 패턴으로 거의 배타적으로 결정 됩니다.

    예를 들어, 텍스트 처리 및 데이터 입력을 처리 하는 응용 프로그램 풍부한 그래픽 및 비디오 재생 대역폭 사용량이 크게 증가 초래 하는 반면 대역폭의 대략 10에서 100 사이의 초당 킬로 비트를 사용 합니다.

-   로밍 프로필을 파일 공유, 데이터베이스 서버, 전자 메일 서버 및 HTTP 서버에 대 한 응용 프로그램 액세스와 같은 백 엔드 연결 합니다.

    볼륨 및 네트워크 트래픽 프로필을 각 배포에 지정 됩니다.

## <a href="" id="apps"></a>원격 데스크톱 세션 호스트에 대 한 응용 프로그램 튜닝


RD 세션 호스트 서버에서 CPU 사용량의 대부분은 앱에서 생성 됩니다. 데스크톱 앱은 응용 프로그램이 사용자 요청에 응답할 걸리는 시간을 최소화 하기를 사용 하 여 응답성으로 일반적으로 최적화 됩니다. 그러나 서버 환경에서 반드시 동일 하 게 다른 세션에 부정적인 영향을 방지 하는 작업을 완료 하는 데 필요한 CPU 사용량의 총 크기를 최소화 하기 위해 합니다.

RD 세션 호스트 서버에서 사용할 수 있는 앱을 구성할 때 다음 사항을 고려 합니다.

-   백그라운드 유휴 루프 처리를 최소화 합니다.

    일반적인 예로 배경 문법 및 맞춤법 검사, 데이터 검색에 대 한 인덱싱을 해제 하는 백그라운드 저장 합니다.

-   앱 상태 확인 또는 업데이트를 수행 하는 빈도 최소화 합니다.

    이러한 동작을 사용 하지 않도록 설정 하거나 크게 발생 하는 타이머 폴링 반복 사이의 간격을 늘리는 CPU 사용량이 많은 활성 세션에 대 한 이러한 작업의 영향을 증폭 신속 하 게 됩니다 때문에 유용 합니다. 일반적인 예로 연결 상태 아이콘 및 상태 표시줄 정보 업데이트 합니다.

-   동기화 빈도 줄여 앱 간에 리소스 경합을 최소화 합니다.

    이러한 리소스의 예로 구성 파일과 레지스트리 키를 들 수 있습니다. 응용 프로그램 구성 요소 및 기능의 예로 상태 표시기 (예: 셸 알림), 백그라운드 인덱싱 또는 변경 모니터링 및 오프 라인 동기화를 들 수 있습니다.

-   로그인 사용자 또는 세션 시작을 시작 하려면 등록 된 불필요 한 프로세스를 사용 하지 않도록 설정 합니다.

    아침 시나리오에서 매우 비용이 많이 드는 수 및 CPU를 많이 사용 프로세스는 일반적으로, 새 사용자 세션을 만들 때 이러한 프로세스 CPU 사용량의 비용 참가할 크게 수 있습니다. MsConfig.exe 또는 MsInfo32.exe를 사용 하 여 사용자 로그인에서 시작 된 프로세스 목록을 가져옵니다. 자세한 정보를 사용할 수 있습니다 [Autoruns에 대 한 Windows](https://technet.microsoft.com/sysinternals/bb963902.aspx)합니다.

메모리 사용에 대 한 다음을 고려해 야 합니다.

-   앱에서 로드 한 Dll은 재배치 되지 있는지 확인 합니다.

    -   위치가 변경 된 Dll를 사용 하 여 다음 그림에 표시 된 대로 프로세스 DLL 보기를 선택 하 여 확인할 수 있습니다 [Process Explorer](https://technet.microsoft.com/sysinternals/bb896653.aspx)합니다.

    -   여기서 볼 수 있는 해당 y.dll x.dll 이미 해당 기본 기준 주소를 사용 하 고 ASLR을 사용할 수 없습니다 때문에 재배치 했습니다.

        ![위치가 변경 된 dll](../../media/perftune-guide-relocated-dlls.png)

        Dll을 재배치 하는 경우 수 없는 세션에서 해당 코드를 공유할는 세션의 메모리 사용량이 크게 증가 합니다. RD 세션 호스트 서버에서 가장 일반적인 메모리 관련 성능 문제 중 하나입니다.

-   공용 언어 런타임 (CLR) 응용 프로그램에 대 한 네이티브 이미지 생성기 (Ngen.exe)를 사용 하 여 페이지에서 공유를 향상 시키고 CPU 오버 헤드 감소 합니다.

    가능한 경우 다른 유사한 실행 엔진으로 유사한 방법을 적용 됩니다.

## <a href="" id="host"></a>매개 변수를 튜닝 하는 원격 데스크톱 세션 호스트


### <a name="page-file"></a>페이지 파일

부족 한 페이지 파일 크기 앱 또는 시스템 구성 요소에서 메모리 할당 오류를 발생할 수 있습니다. 시스템에는 커밋된 가상 메모리 양을 모니터링 하는 커밋된 메모리 바이트 성능 카운터를 사용할 수 있습니다.

### <a name="antivirus"></a>바이러스 백신

RD 세션 호스트 서버에서 바이러스 백신 소프트웨어를 크게 설치 특히 CPU 사용량이 전체 시스템 성능이 영향을 줍니다. 임시 파일을 저장 하는 모든 폴더 활성 모니터링 목록에서 제외, 특히 서비스는 및 기타 시스템 구성 요소를 생성 하는 것이 좋습니다.

### <a name="task-scheduler"></a>작업 스케줄러

작업 Scheduler를 사용 하면 다른 이벤트에 대 한 예약 된 작업 목록을 검사 수 있습니다. RD 세션 호스트 서버를 유휴 상태에서 실행, 로그인 사용자 또는 세션에서 연결 및 분리 하도록 구성 된 작업에 특히 초점을 맞춰 유용 합니다. 배포의 세부 정보, 때문에 이러한 작업의 대부분 필요가 없습니다.

### <a name="desktop-notification-icons"></a>바탕 화면 알림 아이콘

바탕 화면에서 알림 아이콘에는 비용이 많이 드는 새로 고침 메커니즘 있을 수 있습니다. 시작 목록에서이 등록 하는 구성 요소를 제거 하거나 앱 및 비활성화 시스템 구성 요소에서 구성을 변경 하 여 모든 알림을 사용 하지 않도록 합니다. 사용할 수 있습니다 **사용자 지정 알림 아이콘** 서버에서 사용할 수 있는 알림 목록을 검사 합니다.

### <a name="remotefx-data-compression"></a>RemoteFX 데이터 압축

아래에서 그룹 정책을 사용 하 여 Microsoft RemoteFX 압축을 구성할 수 있습니다 **컴퓨터 구성 &gt; 관리 템플릿 &gt; Windows 구성 요소 &gt; Remote Desktop Services &gt; 원격 데스크톱 세션 호스트 &gt; 원격 세션 환경을 &gt; RemoteFX 데이터에 대 한 압축을 구성할**합니다. 세 개의 값은 가능 합니다.

-   **작은 메모리를 사용 하도록 최적화 된** 세션 당 메모리의 최소 크기를 사용 하지만 가장 낮은 압축률 및 가장 높은 대역폭 소비 합니다.

-   **메모리 및 네트워크 대역폭을 분산** 이다을 늘리면 메모리 사용량이 (세션 마다 약 200kb 이하의) 하는 동안 대역폭 소비가 감소 합니다.

-   **네트워크 대역폭을 덜 사용 하도록 최적화 된** 추가 네트워크 대역폭 사용량의 약 2MB 세션당 비용을 줄입니다. 이 설정을 사용 하려는 경우 세션의 최대 수를 평가 하 고 프로덕션 환경에서 서버를 배치 하기 전에이 설정 사용 하 여 해당 수준으로 테스트 해야 합니다.

RemoteFX 압축 알고리즘을 사용 하지 않도록 수도 있습니다. RemoteFX 압축 알고리즘을 사용 하지 않도록 선택은 더 큰 네트워크 대역폭을 사용 하며 경우에 권장 네트워크 소통량을 최적화 하도록 설계 된 하드웨어 장치를 사용 하는 경우. RemoteFX 압축 알고리즘을 사용 하지 않으려는 경우에 일부 그래픽 데이터 압축 됩니다.

### <a name="device-redirection"></a>장치 리디렉션

장치 리디렉션을 아래에서 그룹 정책을 사용 하 여 구성할 수 있습니다 **컴퓨터 구성 &gt; 관리 템플릿 &gt; Windows 구성 요소 &gt; Remote Desktop Services &gt; 원격 데스크톱 세션 호스트 &gt; 장치 및 리소스 리디렉션** 여는 **세션 컬렉션** 속성 상자에서 서버 관리자.

일반적으로 장치 리디렉션 클라이언트 컴퓨터에서 장치 및 서버 세션에서 실행 되는 프로세스 간의 데이터 교환 하기 때문에 네트워크 대역폭 RD 세션 호스트 서버 연결을 사용 하는 얼마나 증가 합니다. 증가 범위는 리디렉션된 장치에 대해 서버에서 실행 되는 응용 프로그램에서 수행 되는 작업의 빈도 함수입니다.

프린터 리디렉션 및 플러그 앤 플레이 장치 리디렉션 로그인 시 CPU 사용량이 늘어납니다. 두 가지 방법으로 프린터를 리디렉션할 수 있습니다.

-   일치 하는 프린터 드라이버 기반 리디렉션 때 프린터 드라이버를 서버에 설치 되어야 합니다. 이전 버전의 Windows Server는이 메서드를 사용 합니다.

-   Windows Server 2008에 도입 된, Easy Print 프린터 드라이버 리디렉션 모든 프린터에 대 한 일반적인 프린터 드라이버를 사용 합니다.

연결 시 프린터 설치에 대 한 CPU 사용량이 적을 하면 되므로 Easy Print 메서드를 좋습니다. 일치 하는 드라이버 메서드를 호출 하면 다른 드라이버를 로드 스풀러 서비스를 필요 하기 때문에 CPU 사용량이 증가 합니다. 대역폭 사용량에 대 한 간편 인쇄 하면 약간 증가 한 네트워크 대역폭 사용 하지만 다른 성능, 관리 효율성 및 안정성 이점을 오프셋 만큼 중요 하지 않습니다.

오디오 리디렉션 엄청나게 많은 네트워크 트래픽 발생합니다. 오디오 리디렉션을 사용자가 일반적으로 높은 CPU 사용량을 포함 하는 멀티미디어 앱을 실행할 수 있습니다.

### <a name="client-experience-settings"></a>클라이언트 환경 설정

기본적으로 연결 RDC (원격 데스크톱) 오른쪽 환경 설정을 서버 및 클라이언트 컴퓨터 간의 네트워크 연결의 적합성에 따라 자동으로 선택 합니다. RDC 구성을 유지 하는 것이 좋습니다 **연결 품질을 자동으로 검색**합니다.

RDC 고급 사용자에 대 한 원격 데스크톱 서비스 연결에 대 한 네트워크 대역폭 성능에 영향을 주는 설정의 범위에 대 한 제어를 제공 합니다. 사용 하 여 다음 설정에 액세스할 수 있습니다 합니다 **환경을** 원격 데스크톱 연결 또는 RDP 파일의 설정 탭입니다.

다음 설정에는 모든 컴퓨터에 연결할 때 적용 됩니다.

-   **배경 무늬 사용 안 함** 리디렉션된 연결에서 바탕 화면 배경 무늬 (사용 안 함 배경 무늬: i:0)에 표시 되지 않습니다. 이 설정은 바탕 화면 배경 이미지 또는 기타 콘텐츠 그리기에 대 한 상당한 비용을 사용 하 여 구성 된 경우 대역폭 사용량을 크게 줄일 수 있습니다.

-   **캐시를 비트맵** 세션에서 렌더링 되는 비트맵의 클라이언트 쪽 캐시를 만듭니다 (Bitmapcachepersistenable:i:1)이이 설정을 사용 합니다. 대역폭 사용량 향상 제공 (없는 기타 보안 고려 사항)에 항상 사용 해야 합니다.

-   **마우스로 끄는 동안 창의 내용을 표시** (전체 창 끌기: i:1 사용 안 함)이이 설정이 비활성화 된 경우에 대역폭 창으로 끌 때만 모든 콘텐츠 대신 창 프레임을 표시 하 여 감소 합니다.

-   **메뉴 및 창 애니메이션** (사용 안 함 메뉴 anims:i:1 및 커서 설정: i:1 사용 안 함): 이러한 설정을 비활성화 되 면 (예: 페이드) 메뉴와 커서에 대 한 애니메이션을 사용 하지 않도록 설정 하 여 대역폭을 감소 합니다.

-   **글꼴 다듬기** (글꼴 다듬기 허용: i:0) 컨트롤 ClearType 글꼴 렌더링 지원 합니다. 이상 Windows 8 또는 Windows Server 2012를 실행 하는 컴퓨터에 연결 하는 경우 사용 하도록 설정 하거나이 설정을 사용 하지 않도록 설정 되지 않은 큰 영향을 주는 대역폭 사용량에 합니다. 그러나 Windows 7 및 Windows 2008 R2 보다 이전 버전을 실행 하는 컴퓨터에서이 설정을 사용 하면 영향을 네트워크 대역폭 사용량 크게.

다음 설정을 Windows 7 및 이전 운영 체제 버전을 실행 하는 컴퓨터에 연결 하는 경우에 적용 됩니다.

-   **바탕 화면 혼합** 이 설정은 Windows 7 또는 Windows Server 2008 R2를 실행 하는 컴퓨터에 대 한 원격 세션에 대해서만 지원 됩니다.

-   **비주얼 스타일** (테마: i:1 사용 안 함)이이 설정이 비활성화 된 경우에 대역폭 Classic 테마를 사용 하는 테마 드로잉을 단순화 하 여 감소 합니다.

사용 하 여 합니다 **환경을** 탭 원격 데스크톱 연결 내에서 네트워크 대역폭 성능에 영향을 줄 수 있는 연결 속도 선택할 수 있습니다. 다음은 연결 속도 구성할 수 있는 옵션에 대 한 목록입니다.

-   **연결 품질을 자동으로 검색** (연결 형식: i:7)이이 설정을 사용 하는 경우 원격 데스크톱 연결 설정을 연결 품질을 기반으로 하는 최적의 사용자 환경을 이어지는 자동으로 선택 합니다. (이 구성은 권장 하며 위에 Windows 8 또는 Windows Server 2012를 실행 하는 컴퓨터에 연결할 때).

-   **모뎀 (56kbps)(** (연결 형식: i:1)이이 설정은 영구 비트맵 캐싱을 사용 하도록 설정 합니다.

-   **낮은 속도 광대역 256k-2mbps** (연결 형식: i:2)이이 설정은 영구 비트맵 캐싱 및 시각적 스타일 사용 하도록 설정 합니다.

-   **셀룰러/위성 (2Mbps-높은 대기 시간으로 16 Mbps)** (연결 형식: i:3) 바탕 화면 혼합, 영구 비트맵 캐싱, 비주얼 스타일 및 바탕 화면 배경이이 설정을 사용 하도록 설정 합니다.

-   **고속 광대역 (2mbps – 10mbps)** (연결 형식: i:4)이이 설정을 통해 바탕 화면 혼합, 끌어, 메뉴 및 창 애니메이션, 영구 비트맵 캐싱, 비주얼 스타일 및 바탕 화면 배경 하는 동안 창의 내용을 표시 합니다.

-   **WAN (10mbps 이상 대기 시간이 긴)** (연결 형식: i:5)이이 설정을 통해 바탕 화면 혼합, 끌어, 메뉴 및 창 애니메이션, 영구 비트맵 캐싱, 비주얼 스타일 및 바탕 화면 배경 하는 동안 창의 내용을 표시 합니다.

-   **LAN (10mbps 이상)** (연결 형식: i:6)이이 설정을 통해 바탕 화면 혼합, 끌어, 메뉴 및 창 애니메이션, 영구 비트맵 캐싱, 테마 및 바탕 화면 배경 하는 동안 창의 내용을 표시 합니다.

### <a name="desktop-size"></a>바탕 화면 크기

원격 데스크톱 연결의 표시 탭을 사용 하 여 또는 RDP 구성 파일 (desktopwidth:i:1152 및 desktopheight:i:864)를 사용 하 여 원격 세션에 대 한 바탕 화면 크기를 제어할 수 있습니다. 데스크톱 크기가 클수록, 큼 메모리 및 대역폭 사용량을 해당 세션을 사용 하 여 연결 합니다. 현재 최대 데스크톱 크기는 4096 x 2048입니다.
