---
title: 이해 하 고 Hyper-v 하이퍼바이저 스케줄러 형식을 사용 하 여
description: 모드 Hyper-v의 스케줄러를 사용 하 여 Hyper-v 호스트 관리자에 대 한 정보를 제공
author: allenma
ms.author: allenma
ms.date: 08/14/2018
ms.topic: article
ms.prod: windows-server-hyper-v
ms.technology: virtualization
ms.localizationpriority: low
ms.assetid: 6cb13f84-cb50-4e60-a685-54f67c9146be
ms.openlocfilehash: 7af6d68b02367d349580eacb27405c6f37e97ff8
ms.sourcegitcommit: 3883eebbba70bfea0221e510863ee1a724a5f926
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/29/2018
ms.locfileid: "5783695"
---
# Hyper-v 하이퍼바이저 스케줄러 종류 관리

>적용 대상: Windows 10, Windows Server 2016, Windows Server, 버전 1709, Windows Server 버전 1803, Windows Server 2019

이 문서는 Windows Server 2016에서 처음 도입 하는 논리를 예약 하는 가상 프로세서의 새 모드에 설명 합니다. 이러한 모드 또는 스케줄러 형식에는 Hyper-v 하이퍼바이저 할당 하 고는 게스트 가상 프로세서에서 작업을 관리 하는 방법 결정 합니다. Hyper-v 호스트 관리자는 게스트 가상 컴퓨터 (Vm)에 가장 적합 하 고 일정 논리를 활용 하기 위해 Vm을 구성 하는 하이퍼바이저 스케줄러 유형을 선택할 수 있습니다.

>[!NOTE]
>이 문서에 설명 된 하이퍼바이저 스케줄러 기능을 사용 하 여 업데이트가 필요 합니다. 세부 정보, [필요한 업데이트를](#required-updates)참조 하세요.

## Background

논리 및 예약 하는 Hyper-v 가상 프로세서 뒤 컨트롤을 설명 하기 전에이 문서에에서 나와 있는 기본 개념을 검토 하는 것이 좋습니다.

### SMT 이해

다중 스레딩, 동시 또는 SMT, 프로세서의 리소스를 별도 독립 실행 스레드에서 공유할 수 있도록 최신 프로세서 디자인에서 활용 하는 기술입니다. 일반적으로 SMT 명령 처리량을 증가 가능 하면 계산을 병렬화 하 여 대부분의 워크 로드를 1024epx 이상의 상당한 성능 향상을 제공, 경합 사이 대 한 스레드 하지만 성능 얻거나 성능이 약간 저하에도 발생할 수 있습니다. 공유 프로세서 리소스 발생 합니다.
SMT를 지 원하는 프로세서 Intel 및 AMD 모두에서 사용할 수 있습니다. Intel은 Intel 하이퍼 스레딩 기술을 또는 Intel HT 자신의 SMT 제품에 대 한 참조합니다.

이 문서에서는 SMT 및 Hyper-v에서 사용 하는 방법을 설명 Intel 및 AMD 모두 시스템에 동일 하 게 적용 됩니다.

* Intel HT 기술에 대 한 자세한 내용은 [Intel 하이퍼 스레딩 기술](https://www.intel.com/content/www/us/en/architecture-and-technology/hyper-threading/hyper-threading-technology.html) 참조

* ["Zen" Core 아키텍처](https://www.amd.com/en/technologies/zen-core) AMD SMT에 대 한 자세한 내용은 참조

## Hyper-v 프로세서를 가상화 하는 방법을 이해 합니다.

하이퍼바이저 스케줄러 종류를 고려 하기 전에 Hyper-v 아키텍처를 이해 하는 데 도움이 이기도 합니다. [Hyper-v 기술 개요](https://docs.microsoft.com/windows-server/virtualization/hyper-v/hyper-v-technology-overview)에서 일반 요약을 찾을 수 있습니다. 다음은이 문서에 대 한 중요 한 개념입니다.

* Hyper-v를 만들고 가상 컴퓨터 파티션, 리소스는 계산에서 할당 및 하이퍼바이저 제어 공유를 관리 합니다. 파티션 및 게스트 Vm 및 루트 파티션에 모든 게스트 가상 컴퓨터 사이의 강력한 격리 경계를 제공합니다.

* 루트 파티션이 파티션입니다 자체 가상 컴퓨터를 고유 속성 및 게스트 가상 컴퓨터 보다 훨씬 더 높은 권한을 하지만 합니다. 루트 파티션 모든 게스트 가상 컴퓨터를 제어 하는 관리 서비스를 제공 하 고, 게스트 가상 디바이스 지원을 제공, 게스트 가상 컴퓨터에 대 한 모든 장치 I/O를 관리 합니다. 루트 파티션에서 모든 응용 프로그램 작업을 실행 하지 않는 것이 좋습니다.

* 루트 파티션 각 가상 프로세서 (VP)에 내부 논리 프로세서 (LP) 매핑된 1:1입니다. 호스트 VP는 동일한 기본 LP 항상 실행 됩니다. – 루트 파티션에 Vp 마이그레이션 없습니다.

* 기본적으로 호스트 Vp 실행 Lp 게스트 Vp 실행할 수도 있습니다.

* 게스트 VP는 하이퍼바이저에서 사용 가능한 논리 프로세서에서 실행 되도록 예약할 수 있습니다. 하이퍼바이저 스케줄러, 게스트 VP 예약할 때 임시 캐시 위치, NUMA 토폴로지 및 기타 많은 요소를 고려해 야 할 처리 하는 동안의 부사장 LP는 호스트에서 예약 못했습니다 궁극적으로 합니다.

## 하이퍼바이저 스케줄러 유형

Windows Server 2016부터 Hyper-v 하이퍼바이저 스케줄러 논리의 하이퍼바이저 내부 논리 프로세서에서 가상 프로세서를 예약 하는 방법을 결정 하는 몇 가지 모드를 지원 합니다. 이러한 스케줄러 유형은 다음과 같습니다.

- [클래식, 박람회 공유 스케줄러](#the-classic-scheduler)
- [핵심 스케줄러](#the-core-scheduler)
- [루트 스케줄러](#the-root-scheduler)

### 클래식 스케줄러

클래식 스케줄러 Windows Server 2016 Hyper-v를 포함 하 여 도입한 이래 Windows Hyper-v 하이퍼바이저의 모든 버전에 대 한 기본 이었습니다. 클래식 스케줄러 고르게, 게스트 가상 프로세서에 대 한 선점 라운드 로빈 일정 모델을 제공합니다.

클래식 스케줄러 형식은 가장 적합 한 대부분의 기존 Hyper-v 사용에 대 한 – 사설 클라우드, 호스팅 공급자 마다입니다. 성능 특성은 잘 이해 하 고 가장 광범위 한 과도 한 LPs, 많은 형식이 다른 Vm 및 워크 로드를 동시에 실행, 높은 큰 규모를 실행 하는 Vp 가입 같은 가상화 시나리오를 지원 하도록 최적화 됩니다. 제한 없이 Hyper-v 등의 전체 기능을 지 원하는 Vm 성능 설정 합니다.

### 핵심 스케줄러

하이퍼바이저 핵심 스케줄러 새로운 Windows Server 2016 및 Windows 10 버전 1607에에서 도입 된 클래식 스케줄러 논리 대안입니다. 핵심 스케줄러 게스트 워크 로드 격리를 위한 강력한 보안 경계를 SMT 활성화 가상화 호스트에서 실행 되는 Vm 내부에서 워크 로드 성능이 저하 가변성을 제공 합니다. 핵심 스케줄러 동일한 SMT 활성화 가상화 호스트에서 동시에 실행 되는 SMT 및 비 SMT 둘 다 가상 컴퓨터 수 있습니다.

핵심 스케줄러 가상화 호스트의 SMT 토폴로지를 이용 하 고 필요에 따라 SMT 논리 프로세서 그룹에 동일한 가상 컴퓨터에서 게스트 가상 컴퓨터와 게스트 가상 프로세서의 일정에 따라 그룹에 SMT 쌍을 노출 합니다. Lp에 있는 경우 두, Vp 그룹 2의 그룹에 예약 되어 이동한 코어가 Vm 간에 공유 되지 대칭 수행 됩니다.
SMT 없이 가상 컴퓨터의 부사장 예정 된 시기를 사용 하도록 실행 될 때 VP 전체 코어를 사용 합니다.

핵심 스케줄러의 전체 결과:

* 게스트 Vp 프로세서 코어 경계에 VM을 격리, 악성 Vm에서 다른 공격 쪽 채널 취약성을 줄입니다 물리적 코어 쌍 내부에서 실행 하도록 제한 됩니다.

* 처리량의 크게 줄어듭니다.

* 코어에서 명령 스트림 중 하나에 실행 다른 유휴 상태가 될 때만 Vp 그룹 중 하나를 실행 되기 때문에 성능이 잠재적으로 저하 됩니다.

* OS 및 게스트 가상 컴퓨터에서 실행 하는 응용 프로그램 SMT 동작 및 프로그래밍 인터페이스 (Api)를 제어 하 고 작업을 분배 SMT 스레드가 가상화 되지 않은 실행 되는 것 처럼 활용할 수 있습니다.

* 게스트 워크 로드 격리 Vp 게스트에 대 한 강력한 보안 경계 쪽 채널 다른 공격 취약성을 줄여 기본 물리적 코어 쌍에서 실행 하도록 제한 됩니다.

핵심 스케줄러 Windows Server 2019부터 기본적으로 사용 됩니다. Windows Server 2016에서 핵심 스케줄러는 선택 사항이 고 Hyper-v 호스트 관리자에서 명시적으로 적용 해야 및 클래식 스케줄러 기본값입니다.

#### 호스트와 핵심 스케줄러 동작 SMT 비활성화

하이퍼바이저 코어 스케줄러 종류를 사용 하도록 구성 된 SMT 기능은 사용 안 함 또는 가상화 호스트에 없는 경우 하이퍼바이저에서 설정 하이퍼바이저 스케줄러 유형에 관계 없이 클래식 스케줄러 동작을 사용 합니다.

### 루트 스케줄러

Windows 10 버전 1803 루트 스케줄러 도입 되었습니다. 루트 스케줄러 종류를 사용 하면 하이퍼바이저 cedes 루트 파티션에 작업 예약에 대 한 제어 합니다. 루트 파티션에 OS 인스턴스에서 NT 스케줄러 Lp 시스템 작업을 예약의 모든 측면을 관리 합니다.

루트 스케줄러 Windows Defender Application Guard (활성화)로 사용 되는 강력한 워크 로드 격리를 제공 하기 위해 유틸리티 파티션을 지원 내재 된 고유한 요구를 해결 합니다. 이 시나리오에서는 루트 OS 책임 예약을 벗어나지는 여러 가지 이점을 제공 합니다. 예를 들어, 관리 및 배포를 간소화 하는 유틸리티 파티션을 사용 하 여 컨테이너 시나리오에 적용할 수 있는 CPU 리소스 컨트롤을 사용할 수 있습니다. 또한 루트 OS 스케줄러 수 쉽게 컨테이너 내에서 CPU 사용률 워크 로드에 대 한 메트릭을 수집 및 다른 모든 워크 로드에 적용할 수 있는 동일한 일정 정책에 대 한 입력으로이 데이터를 사용 하 여 시스템에서. 이러한 동일한 메트릭 응용 프로그램 컨테이너 호스트 시스템에 수행 된 작업 특성 명확 하 게 데도 도움이. 이러한 메트릭을 추적 중 더 어렵습니다 기존의 가상 컴퓨터 워크 로드를 사용 하 여 모든 실행 중인 VM 대신 하 여 일부 작업 발생 루트 파티션에.

#### 클라이언트 시스템에서 루트 스케줄러 사용

Windows 10 버전 1803 부터는 루트 스케줄러는 기본적으로 사용 클라이언트 시스템 에서만, 제대로 작동 하는 향후 시스템 및 가상화 기반 보안 및 WDAG 워크 로드 격리를 지원 하기 위해 하이퍼바이저 사용할 수 있는 다른 유형의 핵심 아키텍처입니다. 클라이언트 시스템에 대 한 지원 되는 유일한 하이퍼바이저 스케줄러 구성입니다. 관리자가 Windows 10 클라이언트 시스템에서 기본 하이퍼바이저 스케줄러 종류를 재정의 하지 않아야 합니다.

#### 가상 컴퓨터의 CPU 리소스 컨트롤 및 루트 스케줄러

Hyper-v에서 제공 하는 가상 컴퓨터 프로세서 리소스 컨트롤에는 루트 운영 체제 스케줄러 논리 전역 단위로 호스트 리소스를 관리 하 고 VM의 지식이지 않습니다. 하이퍼바이저 루트 스케줄러를 사용할 때 지원 되지 않습니다. 특정 구성 설정 합니다. 하이퍼바이저 VP 일정 같은 기본 형식과 핵심 스케줄러 형식을 사용 하는 것을 직접 제어 하는 경우에 Hyper-v VM 당 프로세서 리소스 컨트롤 예약 caps, 가중치 등 적용 됩니다.

#### 서버는 시스템에서 루트 스케줄러 사용

루트 스케줄러 성능 특성 아직 완전히 규정 되어 다양 한 워크 로드에 많은 서버 가상화 배포의 일반적인에 맞게 조정 된 대로이 시간에 서버에서 Hyper-v를 사용 하 여 사용 하기 위해 권장 되지 않습니다.

## SMT 게스트 가상 컴퓨터에서 사용 하도록 설정

가상화 호스트의 하이퍼바이저 핵심 스케줄러 형식을 사용 하도록 구성 되 면 원한다 면 SMT 에게도 게스트 가상 컴퓨터를 구성할 수 있습니다. 노출 Vp 하이퍼 게스트 가상 컴퓨터에는 게스트 운영 체제 및 검색 하 고 자신의 작업 일정에서 SMT 토폴로지를 활용 하기 위해 VM에서 실행 되는 워크 로드에 스케줄러 수 있습니다. Windows Server 2016에서 게스트 SMT 기본적으로 구성 되지 않았습니다와 Hyper-v 호스트 관리자가 명시적으로 사용할 수 있어야 합니다. Windows Server 2019부터 기본적으로 호스트에서 만든 새 Vm 호스트의 SMT 토폴로지를 상속 합니다.  즉, 코어 당 2 개 SMT 스레드를 사용 하 여 호스트에서 만든 9.0 VM 버전은 또한 코어 당 2 SMT 스레드가 표시 됩니다.

SMT; 게스트 가상 컴퓨터에서 사용 하도록 설정 하려면 PowerShell은 사용 해야 합니다. Hyper-v 관리자에 제공 된 사용자 인터페이스가 없습니다.
게스트 가상 컴퓨터에서 SMT를 활성화 하려면 충분 한 권한이와 형식이 PowerShell 창을 엽니다.

``` powershell
Set-VMProcessor -VMName <VMName> -HwThreadCountPerCore <n>
```

여기서 <n> 은 코어 당 SMT 스레드가 개수 게스트 VM 표시 됩니다.  
<n> = 0 핵심 값 당 호스트의 SMT 스레드 수와 일치 하도록 HwThreadCountPerCore 값을 설정 합니다.

>[!NOTE] 
>HwThreadCountPerCore 설정 = 0은 Windows Server 2019부터 지원 됩니다.

다음은 2 개의 가상 프로세서가 있는 가상 컴퓨터에서 실행 되는 게스트 운영 체제에서 가져온 시스템 정보의 예 및 SMT 사용 하도록 설정 합니다. 게스트 운영 체제는 동일한 코어에 속하는 2 논리 프로세서를 검색 하 고 있습니다.

![게스트 SMT 활성화를 사용 하 여 VM에서에서 msinfo32를 보여 주는 스크린 샷](media/Hyper-V-CoreScheduler-VM-Msinfo32.png)

## Windows Server 2016 Hyper-v 하이퍼바이저 스케줄러 종류를 구성합니다.

Windows Server 2016 Hyper-v는 기본적으로 클래식 하이퍼바이저 스케줄러 모델을 사용합니다. 핵심 스케줄러 해당 실제 SMT 쌍에서 실행 하 고 SMT 해당 게스트 Vp에 대 한 예약 된 가상 컴퓨터의 사용을 지원 하려면 게스트 Vp를 제한 하 여 보안을 강화 하기 위해 사용 하 여 하이퍼바이저를 선택적으로 구성할 수 있습니다.

>[!NOTE]
>Windows Server 2016 Hyper-v를 실행 하는 모든 고객 선택 핵심 스케줄러 가상화 호스트는 잠재적인 악성 게스트 Vm에 대해 가장 적절 하 게 보호 하는 것이 좋습니다.

## Windows Server 2019 Hyper-v 기본값은 핵심 스케줄러 사용

Hyper-v 호스트에서 최적의 보안 구성 배포 확인 하려면 Windows Server 2019 Hyper-v 기본적으로 이제 핵심 하이퍼바이저 스케줄러 모델을 사용 됩니다. 호스트 관리자는 레거시 클래식 스케줄러를 사용 하 여 호스트를 구성할 필요에 따라 수 있습니다. 관리자가 해야 신중 하 게 읽고, 이해 하 고 각 스케줄러 형식에 보안 및 스케줄러 유형 기본 설정을 재정의 하기 전에 가상화 호스트의 성능에 영향을 고려 합니다.  자세한 내용은 [이해 Hyper-v 스케줄러 유형 선택](https://docs.microsoft.com/windows-server/virtualization/hyper-v/manage/understanding-hyper-v-scheduler-type-selection) 을 참조 하세요.

### 필수 업데이트

>[!NOTE]
>이 문서에 설명 된 하이퍼바이저 스케줄러 기능을 사용 하 여 다음 업데이트가 필요 합니다. 이러한 업데이트는 호스트 구성에 필요한 새 'hypervisorschedulertype' BCD 옵션을 지원 하기 위한 포함 됩니다.

| 버전 | 릴리스  | 업데이트 해야 합니다. | KB 문서 |
|--------------------|------|---------|-------------:|
|Windows Server 2016 | 1607 | 2018.07 C | [KB4338822](https://support.microsoft.com/help/4338822/windows-10-update-kb4338822) |
|Windows Server 2016 | 1703 | 2018.07 C | [KB4338827](https://support.microsoft.com/help/4338827/windows-10-update-kb4338827) |
|Windows Server 2016 | 1709 | 2018.07 C | [KB4338817](https://support.microsoft.com/help/4338817/windows-10-update-kb4338817) |
|Windows Server 2019 | 1804 | 없음 | 없음 |

## Windows 서버에서 하이퍼바이저 스케줄러 유형 선택

하이퍼바이저 스케줄러 구성 hypervisorschedulertype BCD 항목을 통해 제어 됩니다.

스케줄러 종류를 선택 하려면 관리자 권한으로 명령 프롬프트를 엽니다.

``` command
     bcdedit /set hypervisorschedulertype type
```

여기서 `type` 중 하나입니다.

* 기본
* Core

변경 내용이 적용 하이퍼바이저 스케줄러 형식 시스템을 다시 부팅 해야 합니다.

>[!NOTE]
>하이퍼바이저 루트 스케줄러 지금은 Windows Server에서 Hyper-v는 지원 되지 않습니다. Hyper-v 관리자 서버 가상화 시나리오를 사용 하 여 사용 하기 위해 루트 스케줄러를 구성 하지 않아야 합니다.

## 현재 스케줄러 유형 확인

하이퍼바이저 시작 시 구성 하이퍼바이저 스케줄러 종류를 보고 하는 가장 최근의 하이퍼바이저 출시 이벤트 ID 2에 대 한 이벤트 뷰어에서 시스템 로그를 검토 하 여 사용 중인 현재 하이퍼바이저 스케줄러 형식을 확인할 수 있습니다. 하이퍼바이저 시작 이벤트는 Windows 이벤트 뷰어에서 또는 PowerShell을 통해 얻을 수 있습니다.

하이퍼바이저 출시 이벤트 ID 2 하이퍼바이저 스케줄러 종류를 나타냅니다. 여기서:

    1 = Classic scheduler, SMT disabled

    2 = Classic scheduler

    3 = Core scheduler

    4 = Root scheduler

![하이퍼바이저 시작 이벤트 ID 2 세부 정보 보여 주는 스크린샷](media/Hyper-V-CoreScheduler-EventID2-Details.png)

![하이퍼바이저 출시 이벤트 ID 2를 표시 하는 이벤트 뷰어를 보여 주는 스크린샷](media/Hyper-V-CoreScheduler-EventViewer.png)

### PowerShell을 사용 하 여 Hyper-v 하이퍼바이저 스케줄러 유형 출시 이벤트를 쿼리 합니다.

쿼리를 PowerShell 프롬프트에서 다음 명령을 입력 PowerShell을 사용 하 여 하이퍼바이저 이벤트 ID 2.

``` powershell
Get-WinEvent -FilterHashTable @{ProviderName="Microsoft-Windows-Hyper-V-Hypervisor"; ID=2} -MaxEvents 1
```

![PowerShell 쿼리 및 하이퍼바이저 출시 이벤트 ID 2에 대 한 결과 보여 주는 스크린 샷](media/Hyper-V-CoreScheduler-PowerShell.png)
