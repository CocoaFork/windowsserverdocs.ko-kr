---
ms.assetid: 342173ca-4e10-44f4-b2c9-02a6c26f7a4a
title: 저장소 공간 다이렉트에서 볼륨 계획
ms.prod: windows-server-threshold
ms.author: cosdar
ms.manager: eldenc
ms.technology: storage-spaces
ms.topic: article
author: cosmosdarwin
ms.date: 01/10/2019
ms.localizationpriority: medium
ms.openlocfilehash: e2d9e6828584f4027aa32cec26572c2290098ab6
ms.sourcegitcommit: 6f5bd789e165baf2b399033dae3eb958d16bc988
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 01/10/2019
ms.locfileid: "9000235"
---
# 저장소 공간 다이렉트에서 볼륨 계획

> 적용 대상: Windows Server 2016, Windows Server 2019

이 항목에서는 파일 시스템, 복원력 유형 및 크기 선택을 포함하여 작업에 대한 성능 및 용량 요구 사항을 충족하기 위해 저장소 공간 다이렉트에서 볼륨을 계획하는 방법에 대한 지침을 제공합니다.

## 검토: 볼륨이란?

볼륨은 Hyper-V 가상 컴퓨터용 VHD 또는 VHDX 파일과 같이 작업에 필요한 파일을 저장하는 데이터 저장소입니다. 볼륨은 저장소 풀의 드라이브를 결합하여 저장소 공간 다이렉트의 내결함성, 확장성 및 성능 이점을 도입합니다.

   >[!NOTE]
   > 저장소 공간 다이렉트에 대한 설명서에서는 CSV(클러스터 공유 볼륨) 및 ReFS와 같은 다른 기본 제공 Windows 기능을 비롯하여 저장소 공간 다이렉트에 속하는 볼륨 및 가상 디스크를 공동으로 참조하기 위해 전체적으로 "볼륨"이라는 용어를 사용하고 있습니다. 저장소 공간 다이렉트를 계획하고 배포하는 데 이러한 구현 수준의 차이점을 반드시 이해할 필요는 없습니다.

![볼륨이란?](media/plan-volumes/what-are-volumes.png)

모든 볼륨은 클러스터에 있는 모든 서버에서 동시에 액세스할 수 있습니다. 생성되고 나면 모든 서버의 **C:\ClusterStorage\** 에 표시됩니다.

![csv-폴더-스크린샷](media/plan-volumes/csv-folder-screenshot.png)

## 만들려는 볼륨의 수 선택

볼륨의 수를 클러스터에 있는 서버 수의 배수로 만드는 것이 좋습니다. 예를 들어 4 명의 서버가 있는 경우 3 또는 5를 사용 하 여 보다 총 4 개의 볼륨이 더 일관 된 성능을 제공 합니다. 이를 통해 클러스터는 서버 간에 볼륨 "소유권"(각 볼륨에 대해 하나의 서버가 메타 데이터 오케스트레이션을 처리함)을 고르게 배포할 수 있습니다.

볼륨의 총 수를 제한 하는 것이 좋습니다.

| WindowsServer 2016          | WindowsServer 2019          |
|------------------------------|------------------------------|
| 클러스터당 최대 32 볼륨 | 클러스터당 최대 64 개의 볼륨 |

## 파일 시스템 선택

저장소 공간 다이렉트에 새로운 [ReFS(복원 파일 시스템)](../refs/refs-overview.md)을 사용하는 것이 좋습니다. ReFS는 가상화를 위해 구축된 뛰어난 파일 시스템으로, 인상적인 성능 가속화 및 데이터 손상에 대한 기본 보호 기능을 제공합니다. Windows Server, 버전 1709 이상에서 데이터 중복 제거를 포함 하는 거의 모든 주요 NTFS 기능을 지원 합니다. 자세한 내용은 ReFS [기능 비교 표](../refs/refs-overview.md#feature-comparison) 를 참조 하세요.

ReFS가 아직 지원하지 않는 기능이 작업에 필요한 경우 대신 NTFS를 사용할 수 있습니다.

   >[!TIP]
   > 서로 다른 파일 시스템을 가진 볼륨이 동일한 클러스터에 공존할 수 있습니다.

## 복원력 유형 선택

저장소 공간 다이렉트에서 볼륨은 복원력을 제공하여 드라이브 또는 서버 오류와 같은 하드웨어 문제로부터 보호하고 소프트웨어 업데이트와 같은 서버 유지 관리 전반에 걸쳐 가용성을 지속적으로 유지할 수 있게 합니다.

   >[!NOTE]
   > 선택할 수 있는 복원력 유형은 사용자가 보유한 드라이브 유형과 별개입니다.

### 서버 두 개가 있는 경우

서버 두 개가 있는 클러스터의 유일한 옵션은 양방향 미러링입니다. 이 경우 모든 데이터의 복사본 두 개가 각 서버에 있는 드라이브에 하나씩 유지됩니다. 저장소 효율성은 50%입니다. 즉, 1TB의 데이터를 기록하려면 저장소 풀에 최소 2TB의 물리적 저장소 용량이 필요합니다. 양방향 미러링은 한 번에 하나의 하드웨어 오류(드라이브 또는 서버)를 안전하게 허용할 수 있습니다.

![양방향 미러](media/plan-volumes/two-way-mirror.png)

세 개 이상의 서버가 있는 경우 대신 다음 복원력 유형 중 하나를 사용하는 것이 좋습니다.

### 서버 세 개가 있는 경우

서버 세 개가 있는 경우 더 나은 내결함성과 성능을 위해 3방향 미러링을 사용해야 합니다. 3방향 미러링은 모든 데이터의 복사본 세 개를 각 서버에 있는 드라이브에 하나씩 유지합니다. 저장소 효율성은 33.3%입니다. 즉, 1TB의 데이터를 기록하려면 저장소 풀에 최소 3TB의 물리적 저장소 용량이 필요합니다. 3방향 미러링은 [한 번에 두 개 이상 하드웨어 문제(드라이브 또는 서버)](storage-spaces-fault-tolerance.md#examples)를 안전하게 허용할 수 있습니다. 2 노드를 사용할 수 없게 되므로 디스크의 2/3을 사용할 수 없으며 가상 디스크에 액세스할 수 없습니다 저장소 풀 쿼럼, 손실 됩니다. 하지만 노드 아래로 수 및 하나 이상의 노드에서 디스크를 다른 실패할 수 있습니다 있으며 가상 디스크가 온라인 상태로 유지 됩니다. 예를 들어 갑자기 또 다른 드라이브나 서버에 장애가 발생할 때 서버 하나를 재부팅하는 경우 모든 데이터가 안전하고 지속적으로 액세스할 수 있는 상태로 유지됩니다.

![3방향 미러](media/plan-volumes/three-way-mirror.png)

### 네 개 이상의 서버가 있는 경우

네 개 이상의 서버가 있는 경우 각 볼륨에 대해 이중 패리티(종종 "삭제 코딩(erasure coding)"이라고 함)를 사용할지 또는 두 가지를 혼합할지 여부를 선택할 수 있습니다.

이중 패리티는 3방향 미러링과 동일한 내결함성을 제공하지만 저장소 효율성은 더 높습니다. 네 개의 서버가 있는 경우 저장소 효율성은 50.0%입니다. 즉, 2TB의 데이터를 저장하려면 저장소 풀에 4TB의 물리적 저장소 용량이 필요합니다. 7개의 서버를 통해 저장소 효율성을 66.7%로 높이고 최대 80.0%의 저장소 효율성을 유지합니다. 패리티 인코딩은 계산을 많이 사용하기 때문에 성능이 제한될 수 있습니다.

![이중 패리티](media/plan-volumes/dual-parity.png)

어떤 복원력 유형을 사용할 것인지 여부는 작업의 요구 사항에 따라 다릅니다. 워크 로드는 각 복원 력 유형 뿐만 아니라 각 복원 유형의 성능 및 저장소 효율성에 잘 맞는 요약 하는 표는 다음과 같습니다.

| **복원 력 유형**| **용량 효율성**| **속도**| **워크 로드**
|--------------------|--------------------------------|--------------------------------|--------------------------
| **미러**         | ![저장소 효율성 보여 주는 33%](media\plan-volumes\3-way-mirror-storage-efficiency.png)<br>3 방향 미러: 33% <br>양방향 미러: 50%     |![성능 보여 주는 100%](media\plan-volumes\three-way-mirror-perf.png)<br> 최고 성능  | 가상화 된 워크 로드<br> 데이터베이스<br>다른 고성능 워크 로드 |
| **미러 가속 패리티** |![저장소 효율성은 50% 정도 표시](media\plan-volumes\mirror-accelerated-parity-storage-efficiency.png)<br> 미러와 패리티의 비율에 따라 달라 집니다. | ![약 20%를 보여 주는 성능](media\plan-volumes\mirror-accelerated-parity-perf.png)<br>보다 훨씬 더 느린를 반영 하지만 이중 패리티 속도도으로, 두 번까지<br> 가장 큰 순차 쓰기 및 읽기 | 백업 및 보관<br> 가상된 데스크톱 인프라     |
| **이중 패리티**               | ![약 80%를 보여 주는 저장소 효율성](media\plan-volumes\dual-parity-storage-efficiency.png)<br>4 명의 서버: 50% <br>16 대의 서버: 최대 80% | ![약 10%를 보여 주는 성능](media\plan-volumes\dual-parity-perf.png)<br>쓰기에서 CPU 사용량 및 가장 높은 I/O 대기 시간<br> 가장 큰 순차 쓰기 및 읽기 | 백업 및 보관<br> 가상된 데스크톱 인프라  |

#### 성능이 가장 중요한 요소인 경우

엄격한 대기 시간 요구 사항이 있는 작업이거나 SQL Server 데이터베이스 또는 성능이 중요한 Hyper-V 가상 컴퓨터 같이 혼합된 임의 IOPS가 많이 필요한 작업은 미러링을 사용하여 성능을 극대화하는 볼륨에서 실행해야 합니다.

   >[!TIP]
   > 미러링은 다른 어떠한 복원력 유형보다도 속도가 빠릅니다. 성능을 보여 주는 거의 모든 작업에 미러링을 사용합니다.

#### 용량이 가장 중요한 요소인 경우

데이터 웨어하우스 또는 '콜드' 저장소와 같이 자주 기록하지 않는 작업은 이중 패리티를 사용하여 저장소 효율성을 극대화하는 볼륨에서 실행해야 합니다. 기존의 파일 서버, VDI(가상 데스크톱 인프라) 같은 다른 특정 작업 또는 빠른 속도의 임의 I/O 트래픽을 많이 생성하지 않고 최고의 성능을 요구하지 않는 다른 작업에서도 재량에 따라 이중 패리티를 사용할 수 있습니다. 패리티는 미러링과 비교할 때 특히 쓰기에서 CPU 사용률 및 IO 대기 시간을 불가피하게 높입니다.

#### 데이터를 대량으로 기록하는 경우

보관 또는 백업 대상과 같이 순차적으로 대량 기록되는 작업에는 하나의 볼륨이 미러링과 이중 패리티를 혼합할 수 있는 Windows Server 2016의 새로운 옵션이 적용될 수 있습니다. 미러링된 부분에 먼저 쓰기가 표시된 다음 패리티 부분으로 점차 이동합니다. 이렇게 하면 계산을 많이 사용하는 패리티 인코딩이 더 오랜 시간 동안 발생하게 함으로써 많은 양의 쓰기가 도착할 때 수집이 가속화되고 리소스 사용률이 감소합니다. 일부 크기를 조정할 때 한 번에 발생하는 쓰기 양(일별 백업 등)이 미러링 부분에 적절히 부합해야 한다는 것을 고려해 보세요. 예를 들어 매일 100GB를 수집하는 경우 150GB~200GB는 미러링을 사용하고 나머지는 이중 패리티를 사용하는 것을 고려해 보세요.

결과로 나타나는 저장소 효율성은 선택한 비율에 따라 달라집니다. [이 데모](https://www.youtube.com/watch?v=-LK2ViRGbWs&t=36m55s)에서 몇 가지 예를 참조하세요.

   >[!TIP]
   > 데이터 injestion 통해 이전는 갑작스러운 쓰기 성능 저하를 관찰 되는 경우 미러링 부분 충분 한지 또는 미러-가속 패리티 사용 사례에 적합 하지는 나타낼 수 있습니다. 예를 들어 경우 400 MB/s 성능 저하 40 m B/s 쓰려고, 미러링 부분을 확장 하거나 3 방향 미러로 전환 것이 좋습니다.

### NVMe, SSD, 및 HDD 배포 정보

두 가지 유형의 드라이브를 사용하는 배포에서 빠른 드라이브는 캐싱을 제공하고 느린 드라이브는 용량을 제공합니다. 이 작업은 자동으로 수행됩니다. 자세한 내용은 [저장소 공간 다이렉트에서 캐시 이해](understand-the-cache.md)를 참조하세요. 이러한 배포에서 모든 볼륨은 결국 같은 유형의 드라이브인 용량 드라이브에 상주합니다.

세 가지 유형의 드라이브를 모두 사용하는 배포에서 가장 빠른 드라이브(NVMe)만 캐싱을 제공하고 나머지 두 가지 유형의 드라이브(SSD 및 HDD)는 용량을 제공합니다. 각 볼륨에 대해 SSD 계층에 전체적으로 상주할지, HDD 계층에 전체적으로 상주할지 또는 두 계층에 걸쳐 상주할지 여부를 선택할 수 있습니다.

   >[!IMPORTANT]
   > 성능이 가장 중요한 작업을 SSD 계층을 사용하여 플래시 전용에 배치하는 것이 좋습니다.

## 볼륨의 크기 선택

각 볼륨의 크기를 제한 하는 것이 좋습니다.

| WindowsServer 2016 | WindowsServer 2019 |
|---------------------|---------------------|
| 최대 32TB         | 최대 64TB         |

   >[!TIP]
   > 파일 서버 작업에서도 공통적으로 나타나듯, VSS(볼륨 섀도 복사본 서비스) 및 Volsnap 소프트웨어 공급자에 의존하는 백업 솔루션을 사용하는 경우 볼륨 크기를 10TB로 제한하면 성능과 안정성이 향상됩니다. 최신 Hyper-V RCT API 및/또는 ReFS 블록 복제 및/또는 기본 SQL 백업 API를 사용하는 백업 솔루션은 최대 32TB 이상까지 제대로 작동합니다.

### 사용 공간

볼륨의 크기는 사용 가능한 용량, 저장할 수 있는 데이터의 양을 의미합니다. **New-Volume** cmdlet의 **-Size ** 매개 변수를 통해 제공되며 **Get-Volume** cmdlet을 실행할 때 **Size** 속성에 표시됩니다.

크기는 저장소 풀을 차지하는 전체 물리적 저장소 용량인 볼륨의 *사용 공간*과는 다릅니다. 사용 공간은 해당 복원력 유형에 따라 달라집니다. 예를 들어, 3방향 미러링을 사용하는 볼륨은 크기보다 세 배가 큰 사용 공간을 가집니다.

볼륨의 사용 공간은 저장소 풀에 잘 맞아야 합니다.

![크기와 사용 공간](media/plan-volumes/size-versus-footprint.png)

### 예약 용량

할당되지 않은 저장소 풀에 일부 용량을 남겨 두면 드라이브에 장애가 발생한 후에도 볼륨이 "바로" 복구할 수 있게 하므로 데이터 안전성과 성능이 향상됩니다. 용량이 부족한 경우 병렬 복구는 장애가 발생한 드라이브가 교체되기 전에도 현재 위치에서 즉각적으로 볼륨을 완전한 복원력으로 복원할 수 있습니다. 이 작업은 자동으로 수행됩니다.

서버당 하나의 용량 드라이브씩 최대 4개의 드라이브를 예약하는 것이 좋습니다. 사용자의 재량에 따라 더 예약할 수 있습니다. 하지만 이 최소 권장 사항은 드라이브의 장애 발생 이후 현재 위치의 즉각적인 병렬 복구를 보장합니다.

![예약](media/plan-volumes/reserve.png)

예를 들어 서버가 두 개 있고 1TB 용량 드라이브를 사용하는 경우 풀에서 2 x 1 = 2TB를 예약합니다. 서버가 세 개 있고 1TB 용량 드라이브를 사용하는 경우 3 x 1 = 3TB를 예약합니다. 서버가 네 개 있고 1TB 용량 드라이브를 사용하는 경우 4 x 1 = 4TB를 예약합니다.

   >[!NOTE]
   > 세 가지 유형의 드라이브(NVMe+SSD+HDD)를 모두 갖춘 클러스터에서는 서버당 하나의 SSD 및 HDD씩 최대 4개의 드라이브를 예약하는 것이 좋습니다.

## 예: 용량 계획

하나의 클러스터에 네 개의 서버를 고려해 보세요. 각 서버에는 용량에 몇 가지 캐시 드라이브 및 16개의 2TB 드라이브가 있습니다.

```
4 servers x 16 drives each x 2 TB each = 128 TB
```

이 128TB의 저장소 풀에서는 드라이브에 장애가 발생한 후 교체할 필요 없이 바로 복구 작업이 수행될 수 있도록 4개의 드라이브(8TB)를 예약합니다. 이렇게 하면 볼륨을 만들 수 있는 풀에 120TB의 물리적 저장소 용량이 남습니다.

```
128 TB – (4 x 2 TB) = 120 TB
```

배포를 통해 일부 활성 Hyper-V 가상 컴퓨터를 호스팅해야 하지만, 보존해야 할 오래된 파일과 백업이 있는 콜드 저장소도 많이 있다고 가정해 보겠습니다. 네 개의 서버를 가지고 있으므로 네 개의 볼륨을 만들겠습니다.

처음 두 개의 볼륨 *Volume1* 및 *Volume2*에 가상 컴퓨터를 저장합니다. (빠른 생성 및 검사점을 위해) 파일 시스템으로 ReFS를 선택하고 복원력을 위해 3방향 미러링을 선택하여 성능을 극대화합니다. 다른 두 개의 볼륨 *Volume 3* 및 *Volume 4*에 콜드 저장소를 저장합니다. (데이터 중복 제거를 위해) 파일 시스템으로 NTFS를 선택하고 복원력을 위해 이중 패리티를 선택하여 성능을 극대화합니다.

모든 볼륨을 동일한 크기로 만들 필요는 없지만 편의상의 예를 들어 모두 12TB로 만들 수 있습니다.

*Volume1* 및 *Volume2*는 각각 12TB x 33.3% = 36TB의 물리적 저장소 용량을 차지합니다.

*Volume3* 및 *Volume4*는 각각 12TB x 50.0% = 24TB의 물리적 저장소 용량을 차지합니다.

```
36 TB + 36 TB + 24 TB + 24 TB = 120 TB
```

네 개의 볼륨은 풀에서 사용할 수 있는 물리적 저장소 용량과 정확하게 일치합니다. 좋습니다!

![예제](media/plan-volumes/example.png)

   >[!TIP]
   > 모든 볼륨을 즉시 만들 필요는 없습니다. 언제든 볼륨을 확장하거나 나중에 새로운 볼륨을 만들 수 있습니다.

편의상 이 예제에서는 1TB = 1,000,000,000,000바이트의 의미로 10진수(밑10)를 사용합니다. 그러나 Windows의 저장 용량은 2진수(밑 2)로 표시됩니다. 예를 들어 2TB 드라이브는 Windows에서 각각 1.82TiB로 표시됩니다. 마찬가지로, 128TB 저장소 풀은 116.41TiB로 표시됩니다. 이것이 예상되는 동작입니다.

## 사용

[저장소 공간 다이렉트에서 볼륨 만들기](create-volumes.md)를 참조하세요.

### 참고 항목

- [저장소 공간 다이렉트 개요](storage-spaces-direct-overview.md)
- [저장소 공간 다이렉트용 드라이브 선택](choosing-drives.md)
- [내결함성 및 저장소 효율성](storage-spaces-fault-tolerance.md)
