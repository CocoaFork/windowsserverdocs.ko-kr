---
title: "클레임은 규칙 언어의 역할"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 07/07/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.assetid: dda9d148-d72f-4bff-aa2a-f2249fa47e4c
ms.technology: identity-adfs
ms.openlocfilehash: 206da33d33cbded0450db29615dc74eb1161cbce
ms.sourcegitcommit: 84a2bdcb92ba6af45781fab9727617e50fa5e911
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/07/2017
---
>적용 대상: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

# <a name="the-role-of-the-claim-rule-language"></a>클레임은 규칙 언어의 역할
클레임 엔진 역할을 사용자 지정 규칙 정의 클레임 규칙 언어 논리가 처리 엔진 하지만 Active Directory Federation Services (ADFS) 청구 규칙 언어 송수신 클레임의 동작에 대 한 관리 문서 블록으로 작동 합니다. 모든 규칙 클레임 엔진에서 처리 됩니다 방법에 대 한 자세한 내용은 참조 하십시오 [클레임 엔진 The 역할](The-Role-of-the-Claims-Engine.md)합니다.  
  
## <a name="creating-custom-claim-rules-using-the-claim-rule-language"></a>사용자 지정 클레임 규칙 클레임 규칙 언어를 사용 하 여 만들기  
ADFS id 클레임 클레임 규칙 언어와의 동작을 결정 사용할 수 있는 사용자 지정 규칙 정의 하는 옵션이 있는 관리자 제공 합니다. 이 항목의 열거 추가 삭제 하 고 수정 클레임 조직에서 요구 하는 사용자 지정 규칙을 클레임 규칙 언어 구문을 예제를 사용할 수 있습니다. 클레임 규칙 언어 구문을 입력 하 여 사용자 지정 규칙 만들 수는 **클레임 사용자 지정 주장를 사용 하 여 보낼** 규칙 서식 합니다.  
  
규칙 서로 세미콜론으로 구분 됩니다.  
  
사용 규칙을 사용자 지정 하는 경우에 대 한 자세한 내용은 참조 [사용자 지정 클레임 규칙을 사용 하는 경우](When-to-Use-a-Custom-Claim-Rule.md)합니다.  
  
## <a name="using-claim-rule-templates-to-learn-about-the-claim-rule-language-syntax"></a>클레임은 규칙 템플릿을 클레임 규칙 언어 구문을 대 한 자세한 내용은 사용 하 여  
ADFS 미리 정의 된 청구 발급 및 청구 일반적인 구현 하는 데 사용할 수 있는 승인 규칙 템플릿 규칙 주장 집합을 제공 합니다. **주장 규칙 편집** 대화 상자 지정된 보안에 대 한 미리 정의 된 규칙 만들 수 있습니다-규칙을 구성 하는 클레임 규칙 언어 구문 볼-클릭 하 여는 **보기 규칙 언어** 규칙에 대 한 탭 합니다. 이 섹션의 정보를 사용 하 여 및 **보기 규칙 언어** 방법을 사용자 지정 규칙 생성 하는 방법에 대 한 의견을 제공할 수 있습니다.  
  
자세한 청구 규칙과 클레임 규칙 서식 파일에 대 한 정보를 참조 [주장 규칙의 역할은](The-Role-of-Claim-Rules.md)합니다.  
  
## <a name="understanding-the-components-of-the-claim-rule-language"></a>클레임은 규칙 언어의 구성 요소 이해  
클레임 규칙 언어의 구분 하 여, 다음과 같은 구성 요소도 구성 되어 있는 "= >" 통신사:  
  
-   조건  
  
-   발급 문의  
  
### <a name="conditions"></a>조건  
입력된 클레임 확인 하 고 규칙의 발급 문을 실행할지 여부를 결정을 규칙의 상황을 사용할 수 있습니다. 조건 계산 해야 하는 논리 식을 나타냅니다에 규칙 본문 실행 해야 합니다. 이 부분을 사용할 수 없거나 논리 참 것으로 간주 됩니다. 즉, 규칙의 본문 항상 실행 됩니다. 조건 일부 함께 논리 통신사와 함께 결합 하는 조건 목록이 포함 되어 ("& &"). 목록에 모든 조건에 평가 해야 평가 전체 조건부 부분에 대해 진정한 참에 합니다. 클레임 선택 통신사 또는 집계 함수 통화 조건이 될 수 있습니다. 이 두 가지는 동시에 선택기 주장 하는 것을 의미 하는 하 고 집계 함수 단일 규칙 조건 부분에 함께 사용할 수 없습니다.  
  
조건이 규칙에서 선택 합니다. 예를 들어, 규칙은 다음 조건이 없는 다음과 같습니다.  
  
```  
=> issue(type = "http://test/role", value = "employee");  
```  
  
세 가지 방법으로 조건 수 있습니다.  
  
-   조건이 단일-조건의 간단한 양식입니다. 검사는 하나의 식;에 대 한 예를 들어 windows 계정 이름을 = 사용자 도메인.  
  
-   여러 상태를이 상태 필요한 규칙 본문; 여러 표현 처리 하기 위해 추가 확인 예를 들어 windows 계정 이름을 도메인 사용자 및 그룹 = contosopurchasers = 합니다.  
  
> [!NOTE]  
> 다른 경우가 발생 이지만 단일 조건을 또는 여러 개의 조건 하위 집합 합니다. 것은 일반 식 (Regex) 조건 라고 합니다. 입력된 식을 가져간 지정 패턴 와일드 사용 됩니다. 어떻게 되는지의 예 사용할 수는 다음과 같습니다.  
  
다음은 사용자 지정 규칙 만드는 데 사용할 수 있는지 조건 종류에 따라 구문 구문 중 몇 가지 표시 합니다.  
  
#### <a name="single--condition-examples"></a>단일-예 조건  
단일-식 조건은 아래에 설명 되어 있습니다. 이러한 지정된 클레임 형식의 클레임 또는 클레임 지정된 클레임 형식 사용 하 여 간단 하 게 확인 하 고 값 주장 하 생성 됩니다.  
  
|조건 설명|구문 예제 조건|  
|-------------------------|----------------------------|  
|이 규칙은 지정된 클레임 유형 ("http://test/name")를 입력된 클레임 확인 하도록 합니다. 일치 하는 클레임 입력된 클레임에 있으면 규칙 일치 하는 클레임 또는 클레임 출력 클레임 설정에 복사 합니다.|``` c: [type == "http://test/name"] => issue(claim = c );```|  
|이 규칙은 지정된 클레임 유형 ("http://test/name")를 입력된 클레임 확인 하며 클레임 값 ("Terry"). 일치 하는 클레임 입력된 클레임에 있으면 규칙 일치 하는 클레임 또는 클레임 출력 클레임 설정에 복사 합니다.|``` c: [type == "http://test/name", value == "Terry"] => issue(claim = c);```|  
  
더 많은-복잡 한 조건은 여러 클레임, 청구, 발행인이 확인 하는 조건 및 조건 일반 식 패턴에 맞는 값을 확인 하려면 확인 하는 조건을 포함 하 여 다음 섹션에 표시 됩니다.  
  
#### <a name="multiple--condition-examples"></a>여러 번 조건 예시  
다음 표에서 예를 들어 여러 번 식 조건의 합니다.  
  
|조건 설명|구문 예제 조건|  
|-------------------------|----------------------------|  
|이 규칙은 2 입력된 클레임을 확인 하려면 각 지정된 클레임 유형 ("http://test/name" 및 "http://test/email"). 두 개의 일치 하는 클레임 입력된 클레임 인 규칙 이름 클레임 출력 청구 집합에 복사 합니다.|``` c1: [type  == "http://test/name"] && c2: [type == "http://test/email"] => issue (claim  = c1 );```|  
  
#### <a name="regular--condition-examples"></a>일반-예 조건  
다음 표에서 일반적인, 식의 예-상태를 기반으로 합니다.  
  
|조건 설명|구문 예제 조건|  
|-------------------------|----------------------------|  
|이 규칙은 때 사용 하는 일반적인 식 확인 e에 대 한 번으로 끝나는 메일 클레임 "@fabrikam.com" 합니다. 일치 하는 클레임 입력된 클레임에서 발견 되 면 규칙 일치 하는 클레임 출력 청구 집합을 복사 합니다.|```c: [type  == "http://test/email", value  =~ "^. +@fabrikam.com$" ] => issue (claim  = c );```|  
  
### <a name="issuance-statements"></a>발급 문의  
사용자 지정 규칙에서 발급 취급 방침에 따라 처리 됩니다 (*문제* 또는 *추가* ) 청구 규칙에 프로그램을 합니다. 원하는 결과 문제 정책에 따라 또는 추가 출력 주장 설정 하거나 문을 규칙 채우려면 입력된 클레임 집합으로 작성 될 수 있습니다. 추가 정책 명시적으로 사용 하는 사용자 지정 규칙 입력에만 값 문제 문을 사용 하 여 사용자 지정 클레임 규칙을 채웁니다 클레임 모두 입력 값 설정 주장과 출력에서 설정 주장 하는 동안 설정 주장 클레임을 채웁니다. 클레임 값 클레임 규칙의 미래 규칙만 사용할 수 하려는 경우 유용 합니다.  
  
예를 들어 다음 그림에서는 들어오는 클레임 클레임 발급 엔진에서 설정 입력 클레임에 추가 됩니다. 첫 번째 사용자 지정 클레임 실행 시간과 도메인 사용자의 기준에 만족 클레임 발급 엔진 처리 추가 정책 및 값 사용 규칙에 논리 **편집기** 입력된 클레임 집합에 추가 됩니다. 편집기 값 입력된 청구 집합에 이기 때문에 규칙 2 수 성공적으로 해당 논리에서 문제 문을 처리 하 고 새로운 값을 생성 **Hello**, 모두 출력에 추가 되는 설정 주장 하 고 입력된 클레임 규칙에 다음 규칙에 사용 하도록 설정 하려면 설정 합니다. 이제 규칙 3 모든는 논리 처리에 대해 입력으로 설정 입력된 클레임에 있는 값을 사용할 수 있습니다.  
  
![광고 FS 역할](media/adfs2_customrule.gif)  
  
#### <a name="claim-issuance-actions"></a>클레임 발급 작업  
규칙 본문 클레임 발급 작업을 나타냅니다. 언어를 인식 하는 두 가지 클레임 발급 동작 가지가 있습니다.  
  
-   **문을:** 문제 정책 클레임 입력과 출력으로 이동 주장 집합을 만듭니다. 예를 들어 다음 해당 클레임 입력된 설정에 따라 새 클레임 문제:  
  
    ```c:[type == "Name"] => issue(type = "Greeting", value = "Hello " + c.value);```  
  
-   **문을 추가:** 추가 정책 입력된 클레임 설정 컬렉션에만 추가할 하는 새로운 클레임 만듭니다. 예를 들어 다음 새 클레임 입력된 클레임 집합을 추가합니다.  
  
    ```c:[type == "Name", value == "domain user"] => add(type = "Role", value = "Editor");``` 
  
규칙의 발급 문을 정의 됩니다 클레임 일치 하는 조건 때 규칙에서 발행 합니다. 두 가지 형태의 인수 및 문 문제에 대해 발급 문 가지가 있습니다.  
  
-   **보통**-일반 발급 문을 리터럴 값 규칙에 또는 클레임의 상황에 맞는 값을 사용 하 여 클레임 드릴 수 있습니다. 일반 발급 문을 하나 또는 둘 다, 다음과 같은 형식의 구성할 수 있습니다.  
  
    -   *복사 주장*: 클레임 복사 출력 클레임 설정에는 기존 클레임의 복사본을 만듭니다. "문제" 발급 문을 함께 때만이 발급 양식을 것이 좋습니다. "을 추가" 발급 문으로 결합할 때 영향을 미치지 필요가 없습니다.  
  
    -   *새 클레임*: 속성 주장 다양 한에 대 한 값을 제공 하는 새 클레임 reates 포맷이 합니다. Claim.Type 지정 해야 합니다. 다른 모든 클레임 속성 옵션은 합니다. 이 양식이 인수 주문 무시 됩니다.  
  
-   **특성 스토어**-특성 스토어에서 검색 된 값이이 양식을 클레임을 만듭니다. 이 특성 검색 하는 동안 네트워크나 디스크 입력/출력 (I/O) 작업 하는 특성 스토어에 대 한 중요 한 발급 취급 방침을 사용 하 여 여러 클레임 종류를 만들 수는 있습니다. 따라서 왕복 정책 엔진와 특성 저장소 간에 수를 제한 하는 것이 좋습니다. 특정된 클레임 형식에 대 한 여러 클레임 만드는 법적 이기도 합니다. 특성 스토어 지정된 클레임 형식에 대 한 여러 값을 반환, 발급 문을 각 반환된 클레임 가치에 대 한 청구 자동으로 만들어집니다. 특성 스토어 구현 매개 변수 인수 쿼리 매개 변수 인수에서 제공 되는 값으로 인수에서 틀 대체 하기 위해 사용 합니다. 틀.NET String.Format () 함수 (예를 들어 {1}, {2} 등)와 동일한 구문을 사용 합니다. 이 형태의 발급 인수 순서 중요 한 그리고 순서 대로 다음 문법에 규정 된 있어야 합니다.  
  
다음 표에서 두 가지 유형의 클레임 규칙에서 발급 취급 방침에 대 한 몇 가지 일반적인 구문을 구문을 설명 합니다.  
  
|발급 문 유형|발급 문 설명|발급 문 구문 예제|  
|---------------------------|----------------------------------|-------------------------------------|  
|보통|다음 규칙 때마다 사용자가 지정 된 청구 유형 및 값 항상 동일한 클레임을 내보냅니다.|```c: [type  == "http://test/employee", value  == "true"] => issue (type = "http://test/role", value = "employee");```|  
|보통|다음 규칙 변환 하나의 클레임 유형 다른 합니다. 클레임 "c" 조건에 맞는 값 발급 정책에서 사용 되는 알림이 표시 됩니다.|```c: [type  == "http://test/group" ] => issue (type  = "http://test/role", value  = c.Value );```|  
|특성 스토어|다음 규칙 수신 클레임 값 특성 스토어 Active Directory 쿼리를 사용 합니다.|```c: [Type  == "http://test/name" ] => issue (store  = "Enterprise AD Attribute Store", types  =  ("http://test/email" ), query  = ";mail;{0}", param  = c.Value )```|  
|특성 스토어|다음 규칙 수신 클레임 값 이전 구성 된 구조적 쿼리 SQL (언어) 특성 스토어 쿼리를 사용 합니다.|```c: [type  == "http://test/name"] => issue (store  = "Custom SQL store", types  =  ("http://test/email","http://test/displayname" ), query  = "SELECT mail, displayname FROM users WHERE name ={0}", param  = c.value );```|  
  
#### <a name="expressions"></a>표현  
클레임 선택기 제약 및 발급 문 매개 변수에 오른쪽에서 사용 됩니다. 다양 한 종류의 지 원하는 언어는 식 가지가 있습니다. 언어에서 모든 식 문자열 기반 문자열 입력으로 수행 하 고 문자열을 생성 이므로 됩니다. 번호나 날짜/시간, 식 등의 다른 데이터 형식을 지원 되지 않습니다. 다음은 유형의 식 지 원하는 언어는 다음과 같습니다.  
  
-   리터럴 문자열: 문자열 값을 양면 (") 따옴표 문자로 구분 합니다.  
  
-   문자열 식 연결: 결과 문자열의 왼쪽 및 오른쪽 값 연결 하 여 만들어집니다입니다.  
  
-   전화 하는 기능: 함수 식별자 하 여 확인 되 고 매개 쉼표도 전달 됩니다-구분된 목록이 대괄호 ("()").  
  
-   가변 이름 점 속성 이름의 형태로 클레임의 속성 액세스: 식별된 클레임 속성 지정된 변수 가치에 대 한 값 결과 합니다. 이러한 방식으로 사용할 수 변수 클레임 선택기에 처음 연결 해야 합니다. 동일한 클레임 선택기 그에 대 한 제한 내 클레임 선택기에 연결 된 변수를 사용 하는 없습니다.  
  
다음 청구 속성 액세스를 위해 사용할 수 있습니다.  
  
-   Claim.Type  
  
-   Claim.Value  
  
-   Claim.Issuer  
  
-   Claim.OriginalIssuer  
  
-   Claim.ValueType  
  
-   Claim.Properties\[property\_name\] (이 반환 빈 문자열 속성 _name 클레임에 속성 컬렉션에서 찾을 수 없는 경우 합니다. )  
  
식 내 전화를 RegexReplace 기능을 사용할 수 있습니다. 이 함수 입력된 식 받고 지정된 패턴와 일치 합니다. 패턴 일치 하는 경우 일치 하는 출력 교체 값으로 대체 됩니다.  
  
#### <a name="exists-functions"></a>기능 있습니다.  
일치 하는 조건이 입력에 있는 설정 주장 하는 클레임 여부를 확인 한 조건에 Exists 기능을 사용할 수 있습니다. 일치 하는 모든 클레임 있는 경우 홈 그룹 정책 발급 한 번만 라고 합니다. "시작" 클레임 단 한 번 실행 다음 예제에서-"MSFT"로 설정 발행인이 개수 클레임은에 관계 없이 발행인이 "MSFT"으로 설정 된 입력된 클레임 설정 컬렉션의 하나 이상 클레임 이면 됩니다. 이 기능을 사용 하 여 발급 중복 청구 되지 않도록 합니다.  
  
```  
exists([issuer == "MSFT"])  
   => issue(type = "origin", value = "Microsoft");  
```  
  
## <a name="rule-body"></a>규칙 본문  
규칙 본문 한 단일 발급 문을 포함 될 수 있습니다. 조건이 Exists 기능을 사용 하지 않고 사용 하는 경우 규칙 본문이 조건 일부 일치 하는 때마다에 대 한 번 실행 됩니다.  
  
## <a name="additional-references"></a>추가 참조  
[사용 하 여 사용자 지정 규칙 클레임 보낼 규칙 만들기](https://technet.microsoft.com/library/dd807049.aspx)  
  

